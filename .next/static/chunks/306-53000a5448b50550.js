"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[306],{2099:(e,t,r)=>{r.d(t,{ND:()=>l,uT:()=>o});var n=r(851);let a="https://jntsodzdafscwksizfov.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",a),console.log("Supabase Anon Key:",s?"Set":"Not set"),a&&s||console.error("Supabase credentials are not set correctly in environment variables");let l=(0,n.UU)(a,s);async function o(e){try{let{data:t,error:r}=await l.from("time_entries").select("*").eq("employee_id",e).order("date",{ascending:!1});if(r)return console.error("Error fetching time entries:",r),[];return t}catch(e){return console.error("Unexpected error fetching time entries:",e),[]}}},2227:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(2115);let a=n.forwardRef(function(e,t){let{title:r,titleId:a,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))})},5306:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(5155),a=r(2115),s=r(2227);let l=a.forwardRef(function(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}),o=a.forwardRef(function(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}),c=a.forwardRef(function(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))});var i=r(7794),d=r(9684),m=r(3568);let u=e=>({id:e.id,name:e.name,description:e.description,client:e.client,status:e.status,startDate:e.start_date,endDate:e.end_date,budget:e.budget?Number(e.budget):void 0,priority:e.priority});function h(e){let{projects:t,abonnements:r}=e,[h,x]=(0,a.useState)("month"),[g,f]=(0,a.useState)(new Date),[b,p]=(0,a.useState)([]),[v,y]=(0,a.useState)([]),[j,w]=(0,a.useState)([]),[N,D]=(0,a.useState)("all"),[k,S]=(0,a.useState)(!1),[E,I]=(0,a.useState)(null),[O,M]=(0,a.useState)(null),[C,A]=(0,a.useState)(null),[L,T]=(0,a.useState)(null),[_,F]=(0,a.useState)(!0),[R,U]=(0,a.useState)("projects"),Y=(0,a.useRef)(0),z=(0,a.useRef)(null);function J(e){let t=e.toISOString().split("T")[0];return v.filter(e=>e.scheduledDate===t)}function P(e){let t=e.toISOString().split("T")[0];return j.filter(e=>e.scheduledDate===t)}(0,a.useEffect)(()=>{(async()=>{try{F(!0);let e=(await (0,i.ui)()).map(e=>({...u(e.projects),scheduledDate:e.scheduled_date,scheduledId:e.id}));y(e);let t=await (0,d.s2)();if(!t)throw Error("No data returned from getScheduledAbonnements");let r=t.map(e=>e.abonnementer?{...e.abonnementer,scheduledDate:e.scheduled_date,scheduledId:e.id}:(console.warn("Missing abonnementer data for scheduled item:",e),null)).filter(Boolean);w(r)}catch(e){console.error("Error fetching scheduled data:",e),m.oR.error("Kunne ikke hente planlagte data")}finally{F(!1)}})()},[]),(0,a.useEffect)(()=>{let e=e=>{z.current&&!z.current.contains(e.target)&&k&&S(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[k]),(0,a.useEffect)(()=>{let e=[],t=new Date,r=new Date(g.getFullYear(),g.getMonth(),1),n=new Date(g.getFullYear(),g.getMonth()+1,0),a=r.getDay(),s=a=0===a?6:a-1,l=new Date(g.getFullYear(),g.getMonth(),0);for(let r=s-1;r>=0;r--){let n=new Date(l.getFullYear(),l.getMonth(),l.getDate()-r);e.push({date:n,dayOfMonth:n.getDate(),isCurrentMonth:!1,isToday:n.toDateString()===t.toDateString(),projects:J(n),abonnements:P(n)})}for(let r=1;r<=n.getDate();r++){let n=new Date(g.getFullYear(),g.getMonth(),r);e.push({date:n,dayOfMonth:r,isCurrentMonth:!0,isToday:n.toDateString()===t.toDateString(),projects:J(n),abonnements:P(n)})}let o=42-e.length;for(let r=1;r<=o;r++){let n=new Date(g.getFullYear(),g.getMonth()+1,r);e.push({date:n,dayOfMonth:r,isCurrentMonth:!1,isToday:n.toDateString()===t.toDateString(),projects:J(n),abonnements:P(n)})}p(e)},[g,v]);let V=e=>["Man","Tirs","Ons","Tors","Fre","L\xf8r","S\xf8n"][e],Z=e=>{I(e)},K=(e,t)=>{e.preventDefault()},q=e=>{e.preventDefault(),Y.current++},B=e=>{e.preventDefault(),Y.current--},W=async(e,t)=>{e.preventDefault(),Y.current=0;let r=t.toISOString().split("T")[0];if(E){if(v.some(e=>e.id===E.id&&e.scheduledDate===r))return void I(null);try{let e=await (0,i.Z4)(E.id,r);if(e){let t={...E,scheduledDate:r,scheduledId:e.id};y([...v,t]),m.oR.success("Prosjekt planlagt")}}catch(e){console.error("Error scheduling project:",e),m.oR.error("Kunne ikke planlegge prosjekt")}finally{I(null)}}if(O){if(!O.id){m.oR.error("Ugyldig vedlikeholdsavtale - mangler ID"),M(null);return}if(j.some(e=>e.id===O.id&&e.scheduledDate===r))return void M(null);try{console.log("Attempting to schedule abonnement:",{id:O.id,date:r});let e=await (0,d.lt)(O.id,r);if(e){console.log("Successfully scheduled abonnement:",e);let t={...O,scheduledDate:r,scheduledId:e.id};w([...j,t]),m.oR.success("Vedlikeholdsavtale planlagt")}else console.error("No result returned from scheduleAbonnement"),m.oR.error("Ingen data returnert fra server")}catch(e){console.error("Detailed error scheduling abonnement:",{error:e instanceof Error?e.message:e,stack:e instanceof Error?e.stack:void 0,abonnementId:O.id,date:r}),e instanceof Error?e.message.includes("JWT expired")||e.message.includes("Invalid API key")?m.oR.error("Autentiseringsfeil - sjekk API-n\xf8kkel"):e.message.includes("foreign key constraint")?m.oR.error("Ugyldig vedlikeholdsavtale-ID"):m.oR.error("Feil ved planlegging: ".concat(e.message)):m.oR.error("Ukjent feil ved planlegging")}finally{M(null)}}},H=async(e,t)=>{try{await (0,i.Ub)(e,t),y(v.filter(r=>r.id!==e||r.scheduledDate!==t)),m.oR.success("Prosjekt fjernet fra kalender")}catch(e){console.error("Error removing project from calendar:",e),m.oR.error("Kunne ikke fjerne prosjekt fra kalender")}},G=async(e,t)=>{try{await (0,d.NA)(e,t),w(j.filter(r=>r.id!==e||r.scheduledDate!==t)),m.oR.success("Vedlikeholdsavtale fjernet fra kalender")}catch(e){console.error("Error removing abonnement from calendar:",e),m.oR.error("Kunne ikke fjerne vedlikeholdsavtale fra kalender")}},X="all"===N?t:t.filter(e=>e.status===N);return(0,n.jsx)("div",{className:"bg-gray-900 rounded-xl border border-gray-800",children:(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"flex border-b border-gray-800",children:[(0,n.jsxs)("button",{className:"px-4 py-3 text-sm font-medium flex items-center ".concat("month"===h?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"),onClick:()=>x("month"),children:[(0,n.jsx)(s.A,{className:"w-4 h-4 mr-2"}),"M\xe5ned"]}),(0,n.jsxs)("button",{className:"px-4 py-3 text-sm font-medium flex items-center ".concat("week"===h?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"),onClick:()=>x("week"),children:[(0,n.jsx)(s.A,{className:"w-4 h-4 mr-2"}),"Uke"]}),(0,n.jsxs)("button",{className:"px-4 py-3 text-sm font-medium flex items-center ".concat("day"===h?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"),onClick:()=>x("day"),children:[(0,n.jsx)(s.A,{className:"w-4 h-4 mr-2"}),"Dag"]})]}),(0,n.jsxs)("div",{className:"flex flex-1",children:[(0,n.jsxs)("div",{className:"w-1/4 border-r border-gray-800 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex border-b border-gray-700",children:[(0,n.jsx)("button",{className:"flex-1 px-4 py-2 text-sm font-medium ".concat("projects"===R?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"),onClick:()=>U("projects"),children:"Prosjekter"}),(0,n.jsx)("button",{className:"flex-1 px-4 py-2 text-sm font-medium ".concat("abonnements"===R?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"),onClick:()=>U("abonnements"),children:"Vedlikeholdsavtaler"})]}),"projects"===R&&(0,n.jsxs)("div",{className:"p-4 flex-1 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-white",children:"Prosjekter"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{onClick:()=>S(!k),className:"flex items-center text-sm text-gray-400 hover:text-white",children:[(0,n.jsx)(l,{className:"w-4 h-4 mr-1"}),"Filter: ","all"===N?"Alle":"active"===N?"Aktive":"completed"===N?"Fullf\xf8rte":"Arkiverte"]}),(0,n.jsx)("div",{ref:z,className:"absolute right-0 mt-2 w-48 bg-gray-800 rounded-lg shadow-lg z-10 ".concat(k?"block":"hidden"),children:(0,n.jsxs)("div",{className:"py-1",children:[(0,n.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{D("all"),S(!1)},children:"Alle"}),(0,n.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{D("active"),S(!1)},children:"Aktive"}),(0,n.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{D("completed"),S(!1)},children:"Fullf\xf8rte"}),(0,n.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{D("archived"),S(!1)},children:"Arkiverte"})]})})]})]}),(0,n.jsx)("div",{className:"space-y-2 overflow-y-auto flex-1",children:X.map(e=>(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3 cursor-move hover:bg-gray-750 border border-gray-700",draggable:!0,onDragStart:()=>Z(e),children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-white",children:e.name}),(0,n.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs font-medium ".concat("high"===e.priority?"bg-red-900/50 text-red-400":"medium"===e.priority?"bg-yellow-900/50 text-yellow-400":"bg-green-900/50 text-green-400"),children:e.priority})]}),(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1 truncate",children:e.client})]},e.id))})]}),"abonnements"===R&&(0,n.jsxs)("div",{className:"p-4 flex-1 flex flex-col",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,n.jsx)("h3",{className:"text-lg font-medium text-white",children:"Vedlikeholdsavtaler"})}),(0,n.jsx)("div",{className:"space-y-2 overflow-y-auto flex-1",children:r.map(e=>(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3 cursor-move hover:bg-gray-750 border border-gray-700",draggable:!0,onDragStart:()=>{M(e),I(null)},children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-white",children:e.etternavn}),(0,n.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-900/50 text-blue-400",children:"Vedlikehold"})]}),(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1 truncate",children:e.adresse}),(0,n.jsx)("p",{className:"text-xs text-gray-400 truncate",children:e.kommune})]},e.id))})]})]}),(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-white",children:(()=>{if("month"===h)return g.toLocaleDateString("nb-NO",{month:"long",year:"numeric"});if("week"!==h)return g.toLocaleDateString("nb-NO",{weekday:"long",day:"numeric",month:"long",year:"numeric"});{let e=new Date(g),t=e.getDay();e.setDate(e.getDate()+(0===t?-6:1-t));let r=new Date(e);r.setDate(r.getDate()+6);let n=e.getMonth()===r.getMonth()?"":e.toLocaleDateString("nb-NO",{month:"long"})+" ";return"".concat(n).concat(e.getDate(),". - ").concat(r.toLocaleDateString("nb-NO",{day:"numeric",month:"long",year:"numeric"}))}})()}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{if("month"===h)f(new Date(g.getFullYear(),g.getMonth()-1,1));else if("week"===h){let e=new Date(g);e.setDate(e.getDate()-7),f(e)}else if("day"===h){let e=new Date(g);e.setDate(e.getDate()-1),f(e)}},className:"p-1.5 rounded-full text-gray-400 hover:text-white hover:bg-gray-800",children:(0,n.jsx)(o,{className:"w-5 h-5"})}),(0,n.jsx)("button",{onClick:()=>{f(new Date)},className:"px-3 py-1.5 text-sm text-gray-400 hover:text-white",children:"I dag"}),(0,n.jsx)("button",{onClick:()=>{if("month"===h)f(new Date(g.getFullYear(),g.getMonth()+1,1));else if("week"===h){let e=new Date(g);e.setDate(e.getDate()+7),f(e)}else if("day"===h){let e=new Date(g);e.setDate(e.getDate()+1),f(e)}},className:"p-1.5 rounded-full text-gray-400 hover:text-white hover:bg-gray-800",children:(0,n.jsx)(c,{className:"w-5 h-5"})})]})]}),(0,n.jsxs)("div",{className:"flex-1 p-2",children:["month"===h&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-1",children:[0,1,2,3,4,5,6].map(e=>(0,n.jsx)("div",{className:"text-center text-xs font-medium text-gray-400 py-1",children:V(e)},e))}),(0,n.jsx)("div",{className:"grid grid-cols-7 gap-1 flex-1",children:b.map((e,t)=>(0,n.jsxs)("div",{className:"min-h-[100px] rounded-lg border ".concat(e.isCurrentMonth?e.isToday?"bg-blue-900/20 border-blue-800":"bg-gray-800 border-gray-700":"bg-gray-850 border-gray-800"," p-1 relative"),onDragOver:t=>K(t,e.date),onDragEnter:q,onDragLeave:B,onDrop:t=>W(t,e.date),children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-1",children:(0,n.jsx)("span",{className:"text-xs font-medium ".concat(e.isCurrentMonth?e.isToday?"text-blue-400":"text-white":"text-gray-500"),children:e.dayOfMonth})}),(0,n.jsxs)("div",{className:"space-y-1 overflow-y-auto max-h-[80px] min-h-[60px]",onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("bg-gray-700/50")},onDragLeave:e=>{e.currentTarget.classList.remove("bg-gray-700/50")},onDrop:t=>{t.preventDefault(),t.currentTarget.classList.remove("bg-gray-700/50"),W(t,e.date)},children:[e.projects.map(t=>(0,n.jsxs)("div",{className:"text-xs p-1 rounded relative cursor-move transition-all duration-200 hover:shadow-lg ".concat("high"===t.priority?"bg-red-900/30 text-red-400 border border-red-800/50 hover:bg-red-900/40":"medium"===t.priority?"bg-yellow-900/30 text-yellow-400 border border-yellow-800/50 hover:bg-yellow-900/40":"bg-green-900/30 text-green-400 border border-green-800/50 hover:bg-green-900/40"),onMouseEnter:()=>A("".concat(t.id,"-").concat(e.date.toISOString())),onMouseLeave:()=>A(null),children:[(0,n.jsx)("div",{className:"truncate",children:t.name}),C==="".concat(t.id,"-").concat(e.date.toISOString())&&(0,n.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-48 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-2 text-xs",children:[(0,n.jsx)("h5",{className:"font-medium text-white mb-1",children:t.name}),(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:t.client}),(0,n.jsx)("p",{className:"text-gray-400 mb-1 line-clamp-2",children:t.description}),(0,n.jsx)("button",{onClick:()=>H(t.id,e.date.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs mt-1",children:"Fjern fra kalender"})]})]},"project-".concat(t.id,"-").concat(e.date.toISOString()))),e.abonnements.map(t=>(0,n.jsxs)("div",{className:"text-xs p-1 rounded relative cursor-move transition-all duration-200 hover:shadow-lg bg-blue-900/30 text-blue-400 border border-blue-800/50 hover:bg-blue-900/40",onMouseEnter:()=>T("".concat(t.id,"-").concat(e.date.toISOString())),onMouseLeave:()=>T(null),children:[(0,n.jsx)("div",{className:"truncate",children:t.etternavn}),L==="".concat(t.id,"-").concat(e.date.toISOString())&&(0,n.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-48 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-2 text-xs",children:[(0,n.jsx)("h5",{className:"font-medium text-white mb-1",children:t.etternavn}),(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:t.adresse}),(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:t.kommune}),(0,n.jsx)("button",{onClick:()=>G(t.id,e.date.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs mt-1",children:"Fjern fra kalender"})]})]},"abonnement-".concat(t.id,"-").concat(e.date.toISOString())))]})]},t))})]}),"week"===h&&(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Array.from({length:7}).map((e,t)=>{let r=new Date(g),a=r.getDay(),s=t-(0===a?6:a-1);return r.setDate(r.getDate()+s),(0,n.jsxs)("div",{className:"text-center py-2",children:[(0,n.jsx)("div",{className:"text-xs font-medium text-gray-400",children:V(t)}),(0,n.jsx)("div",{className:"text-sm font-medium ".concat(r.toDateString()===new Date().toDateString()?"text-blue-400":"text-white"),children:r.getDate()})]},t)})}),(0,n.jsx)("div",{className:"grid grid-cols-7 gap-1 flex-1",children:Array.from({length:7}).map((e,t)=>{let r=new Date(g),a=r.getDay(),s=t-(0===a?6:a-1);r.setDate(r.getDate()+s);let l=r.toISOString().split("T")[0],o=v.filter(e=>e.scheduledDate===l),c=j.filter(e=>e.scheduledDate===l);return(0,n.jsx)("div",{className:"min-h-[400px] rounded-lg border ".concat(r.toDateString()===new Date().toDateString()?"bg-blue-900/20 border-blue-800":"bg-gray-800 border-gray-700"," p-2 relative"),onDragOver:e=>K(e,r),onDragEnter:q,onDragLeave:B,onDrop:e=>W(e,r),children:(0,n.jsxs)("div",{className:"space-y-2 overflow-y-auto max-h-full",children:[o.map(e=>(0,n.jsxs)("div",{className:"p-2 rounded relative ".concat("high"===e.priority?"bg-red-900/30 text-red-400 border border-red-800/50":"medium"===e.priority?"bg-yellow-900/30 text-yellow-400 border border-yellow-800/50":"bg-green-900/30 text-green-400 border border-green-800/50"),onMouseEnter:()=>A("".concat(e.id,"-").concat(r.toISOString())),onMouseLeave:()=>A(null),children:[(0,n.jsx)("div",{className:"font-medium",children:e.name}),(0,n.jsx)("div",{className:"text-xs mt-1",children:e.client}),C==="".concat(e.id,"-").concat(r.toISOString())&&(0,n.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-64 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-3 text-sm",children:[(0,n.jsx)("h5",{className:"font-medium text-white mb-1",children:e.name}),(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:e.client}),(0,n.jsx)("p",{className:"text-gray-400 mb-2",children:e.description}),(0,n.jsx)("button",{onClick:()=>H(e.id,l),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},"project-".concat(e.id,"-").concat(r.toISOString()))),c.map(e=>(0,n.jsxs)("div",{className:"p-2 rounded relative bg-blue-900/30 text-blue-400 border border-blue-800/50",onMouseEnter:()=>T("".concat(e.id,"-").concat(r.toISOString())),onMouseLeave:()=>T(null),children:[(0,n.jsx)("div",{className:"font-medium",children:e.etternavn}),(0,n.jsx)("div",{className:"text-xs mt-1",children:e.adresse}),L==="".concat(e.id,"-").concat(r.toISOString())&&(0,n.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-64 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-3 text-sm",children:[(0,n.jsx)("h5",{className:"font-medium text-white mb-1",children:e.etternavn}),(0,n.jsx)("p",{className:"text-gray-400 mb-1",children:e.adresse}),(0,n.jsx)("p",{className:"text-gray-400 mb-2",children:e.kommune}),(0,n.jsx)("button",{onClick:()=>G(e.id,l),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},"abonnement-".concat(e.id,"-").concat(r.toISOString())))]})},t)})})]}),"day"===h&&(0,n.jsx)("div",{className:"flex flex-col h-full",children:(0,n.jsx)("div",{className:"flex-1 p-4 bg-gray-800 rounded-lg border border-gray-700 mt-2 overflow-y-auto",onDragOver:e=>K(e,g),onDragEnter:q,onDragLeave:B,onDrop:e=>W(e,g),children:(0,n.jsxs)("div",{className:"space-y-3",children:[v.filter(e=>e.scheduledDate===g.toISOString().split("T")[0]).map(e=>(0,n.jsxs)("div",{className:"p-4 rounded-lg relative ".concat("high"===e.priority?"bg-red-900/30 text-red-400 border border-red-800/50":"medium"===e.priority?"bg-yellow-900/30 text-yellow-400 border border-yellow-800/50":"bg-green-900/30 text-green-400 border border-green-800/50"),children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)("h4",{className:"font-medium text-white",children:e.name}),(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-blue-900/50 text-blue-400":"completed"===e.status?"bg-green-900/50 text-green-400":"bg-gray-900/50 text-gray-400"),children:e.status})]}),(0,n.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:e.description}),(0,n.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-400",children:["Klient: ",(0,n.jsx)("span",{className:"text-white",children:e.client})]}),(0,n.jsx)("button",{onClick:()=>H(e.id,g.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},"project-".concat(e.id))),j.filter(e=>e.scheduledDate===g.toISOString().split("T")[0]).map(e=>(0,n.jsxs)("div",{className:"p-4 rounded-lg relative bg-blue-900/30 text-blue-400 border border-blue-800/50",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsx)("h4",{className:"font-medium text-white",children:e.etternavn}),(0,n.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-900/50 text-blue-400",children:"Vedlikehold"})]}),(0,n.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:e.adresse}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:e.kommune}),(0,n.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-400",children:["Fornyelse: ",(0,n.jsx)("span",{className:"text-white",children:e.fornyelsesdato})]}),(0,n.jsx)("button",{onClick:()=>G(e.id,g.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},"abonnement-".concat(e.id))),0===v.filter(e=>e.scheduledDate===g.toISOString().split("T")[0]).length&&0===j.filter(e=>e.scheduledDate===g.toISOString().split("T")[0]).length&&(0,n.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,n.jsx)("p",{children:"Ingen aktiviteter planlagt for denne dagen"}),(0,n.jsx)("p",{className:"text-sm mt-2",children:"Dra et prosjekt eller en vedlikeholdsavtale hit for \xe5 planlegge det"})]})]})})})]})]})]})]})})}},7794:(e,t,r)=>{r.d(t,{JQ:()=>a,Ub:()=>d,Z4:()=>i,gA:()=>s,ui:()=>c,vr:()=>l,xx:()=>o});var n=r(2099);async function a(){let{data:e,error:t}=await n.ND.from("projects").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Error fetching projects:",t),t;return e||[]}async function s(e){console.log("Creating project with data:",e);try{console.log("Supabase client:",n.ND);let{data:t,error:r}=await n.ND.from("projects").select("id").limit(1);if(r)throw console.error("Error checking projects table:",r),Error("Table check failed: ".concat(r.message));console.log("Table check result:",t);let{data:a,error:s}=await n.ND.from("projects").insert([e]).select();if(s)throw console.error("Error creating project:",s),Error("Insert failed: ".concat(s.message));return console.log("Project created successfully:",a),null==a?void 0:a[0]}catch(e){throw console.error("Exception in createProject:",e),e}}async function l(e,t){console.log("Updating project with id:",e,"and data:",t);try{let{data:r,error:a}=await n.ND.from("projects").update(t).eq("id",e).select();if(a)throw console.error("Error updating project with id ".concat(e,":"),a),a;return console.log("Project updated successfully:",r),null==r?void 0:r[0]}catch(t){throw console.error("Exception in updateProject for id ".concat(e,":"),t),t}}async function o(e){let{error:t}=await n.ND.from("projects").delete().eq("id",e);if(t)throw console.error("Error deleting project with id ".concat(e,":"),t),t;return!0}async function c(){let{data:e,error:t}=await n.ND.from("scheduled_projects").select("\n      *,\n      projects:project_id (*)\n    ").order("scheduled_date",{ascending:!0});if(t)throw console.error("Error fetching scheduled projects:",t),t;return e||[]}async function i(e,t){let{data:r,error:a}=await n.ND.from("scheduled_projects").insert([{project_id:e,scheduled_date:t}]).select();if(a)throw console.error("Error scheduling project ".concat(e," for date ").concat(t,":"),a),a;return null==r?void 0:r[0]}async function d(e,t){let{error:r}=await n.ND.from("scheduled_projects").delete().eq("project_id",e).eq("scheduled_date",t);if(r)throw console.error("Error unscheduling project ".concat(e," for date ").concat(t,":"),r),r;return!0}},9684:(e,t,r)=>{r.d(t,{CL:()=>c,NA:()=>o,R2:()=>a,lt:()=>l,s2:()=>s});var n=r(2099);async function a(){let{data:e,error:t}=await n.ND.from("abonnementer").select("*").order("etternavn",{ascending:!0});if(t)throw console.error("Error fetching abonnements:",t),t;return e||[]}async function s(){let{data:e,error:t}=await n.ND.from("scheduled_abonnements").select("\n      *,\n      abonnementer:abonnement_id (*)\n    ").order("scheduled_date",{ascending:!0});if(t)throw console.error("Error fetching scheduled abonnements:",t),t;return e||[]}async function l(e,t){try{let r=Number(e);if(isNaN(r))throw Error("Invalid abonnement ID: ".concat(e));if(!t||!Date.parse(t))throw Error("Invalid date format: ".concat(t));let{data:a,error:s}=await n.ND.from("scheduled_abonnements").insert([{abonnement_id:r,scheduled_date:t}]).select();if(s)throw console.error("Error scheduling abonnement ".concat(e," for date ").concat(t,":"),{message:s.message,code:s.code,details:s.details,hint:s.hint}),Error("Failed to schedule: ".concat(s.message));if(!a||0===a.length)throw Error("No data returned from scheduling operation");return a[0]}catch(t){throw console.error("Failed to schedule abonnement ".concat(e,":"),{error:t instanceof Error?t.message:t,stack:t instanceof Error?t.stack:void 0}),Error("Failed to schedule abonnement: ".concat(t instanceof Error?t.message:"Unknown error"))}}async function o(e,t){let{error:r}=await n.ND.from("scheduled_abonnements").delete().eq("abonnement_id",e).eq("scheduled_date",t);if(r)throw console.error("Error unscheduling abonnement ".concat(e," for date ").concat(t,":"),r),r;return!0}async function c(e){let{data:t,error:r}=await n.ND.from("abonnementer").insert([{fornavn:e.fornavn,etternavn:e.etternavn,adresse:e.adresse,kommune:e.kommune,var:e.var,host:e.host,epost:e.epost,fakturert:e.fakturert,fornyelsesdato:e.fornyelsesdato,sum:e.sum,notat:e.notat}]).select();if(r)throw console.error("Error creating abonnement:",r),r;return null==t?void 0:t[0]}}}]);
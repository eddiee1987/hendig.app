(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{2099:(e,r,t)=>{"use strict";t.d(r,{ND:()=>a,uT:()=>i});var s=t(851);let n="https://jntsodzdafscwksizfov.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",n),console.log("Supabase Anon Key:",l?"Set":"Not set"),n&&l||console.error("Supabase credentials are not set correctly in environment variables");let a=(0,s.UU)(n,l);async function i(e){try{let{data:r,error:t}=await a.from("time_entries").select("*").eq("employee_id",e).order("date",{ascending:!1});if(t)return console.error("Error fetching time entries:",t),[];return r}catch(e){return console.error("Unexpected error fetching time entries:",e),[]}}},2523:(e,r,t)=>{"use strict";t.d(r,{p:()=>a});var s=t(5155),n=t(2115),l=t(9434);let a=n.forwardRef((e,r)=>{let{className:t,type:n,...a}=e;return(0,s.jsx)("input",{type:n,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...a})});a.displayName="Input"},4392:(e,r,t)=>{"use strict";t.d(r,{$:()=>f});var s=t(5155),n=t(2115);function l(e,r){if("function"==typeof e)return e(r);null!=e&&(e.current=r)}var a=n.forwardRef((e,r)=>{let{children:t,...l}=e,a=n.Children.toArray(t),o=a.find(d);if(o){let e=o.props.children,t=a.map(r=>r!==o?r:n.Children.count(e)>1?n.Children.only(null):n.isValidElement(e)?e.props.children:null);return(0,s.jsx)(i,{...l,ref:r,children:n.isValidElement(e)?n.cloneElement(e,void 0,t):null})}return(0,s.jsx)(i,{...l,ref:r,children:t})});a.displayName="Slot";var i=n.forwardRef((e,r)=>{let{children:t,...s}=e;if(n.isValidElement(t)){let e=function(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?e.props.ref:e.props.ref||e.ref}(t),a=function(e,r){let t={...r};for(let s in r){let n=e[s],l=r[s];/^on[A-Z]/.test(s)?n&&l?t[s]=(...e)=>{l(...e),n(...e)}:n&&(t[s]=n):"style"===s?t[s]={...n,...l}:"className"===s&&(t[s]=[n,l].filter(Boolean).join(" "))}return{...e,...t}}(s,t.props);return t.type!==n.Fragment&&(a.ref=r?function(...e){return r=>{let t=!1,s=e.map(e=>{let s=l(e,r);return t||"function"!=typeof s||(t=!0),s});if(t)return()=>{for(let r=0;r<s.length;r++){let t=s[r];"function"==typeof t?t():l(e[r],null)}}}}(r,e):e),n.cloneElement(t,a)}return n.Children.count(t)>1?n.Children.only(null):null});i.displayName="SlotClone";var o=({children:e})=>(0,s.jsx)(s.Fragment,{children:e});function d(e){return n.isValidElement(e)&&e.type===o}var c=t(2596);let u=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,m=c.$;var p=t(9434);let g=((e,r)=>t=>{var s;if((null==r?void 0:r.variants)==null)return m(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:n,defaultVariants:l}=r,a=Object.keys(n).map(e=>{let r=null==t?void 0:t[e],s=null==l?void 0:l[e];if(null===r)return null;let a=u(r)||u(s);return n[e][a]}),i=t&&Object.entries(t).reduce((e,r)=>{let[t,s]=r;return void 0===s||(e[t]=s),e},{});return m(e,a,null==r||null==(s=r.compoundVariants)?void 0:s.reduce((e,r)=>{let{class:t,className:s,...n}=r;return Object.entries(n).every(e=>{let[r,t]=e;return Array.isArray(t)?t.includes({...l,...i}[r]):({...l,...i})[r]===t})?[...e,t,s]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)})("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),f=n.forwardRef((e,r)=>{let{className:t,variant:n,size:l,asChild:i=!1,...o}=e,d=i?a:"button";return(0,s.jsx)(d,{className:(0,p.cn)(g({variant:n,size:l,className:t})),ref:r,...o})});f.displayName="Button"},6695:(e,r,t)=>{"use strict";t.d(r,{Zp:()=>a});var s=t(5155),n=t(2115),l=t(9434);let a=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});a.displayName="Card",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...n})}).displayName="CardHeader",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("h3",{ref:r,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})}).displayName="CardTitle",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("p",{ref:r,className:(0,l.cn)("text-sm text-muted-foreground",t),...n})}).displayName="CardDescription",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("p-6 pt-0",t),...n})}).displayName="CardContent",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,l.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},7256:(e,r,t)=>{Promise.resolve().then(t.bind(t,8642))},8642:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var s=t(5155),n=t(2115),l=t(5695),a=t(2099),i=t(4392),o=t(6695),d=t(2523),c=t(9434);let u=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,s.jsx)("textarea",{className:(0,c.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n})});function m(){let e=(0,l.useRouter)(),[r,t]=(0,n.useState)([]),[c,m]=(0,n.useState)(!0),[p,g]=(0,n.useState)(null),[f,x]=(0,n.useState)(null),[b,h]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),[j,N]=(0,n.useState)(""),[k,w]=(0,n.useState)(""),[S,C]=(0,n.useState)("planlagt"),[R,I]=(0,n.useState)(""),[E,V]=(0,n.useState)(""),[O,_]=(0,n.useState)(""),[D,U]=(0,n.useState)(""),[A,J]=(0,n.useState)(!1),[Z,z]=(0,n.useState)([]),[K,T]=(0,n.useState)([]);async function F(){try{m(!0);let{data:e,error:r}=await a.ND.from("abonnementer").select("id, etternavn, adresse, kommune");if(r){console.error("Error fetching customers:",r),g("Kunne ikke hente kunder");return}t(e||[])}catch(e){console.error("Unexpected error:",e),g("En uventet feil oppstod")}finally{m(!1)}}(0,n.useEffect)(()=>{F()},[]);let P=async r=>{if(r.preventDefault(),!b||!k||!R)return void x("Vennligst fyll ut alle p\xe5krevde felt");try{x("Lagrer inspeksjon...");let{error:r}=await a.ND.from("inspections").insert([{customer_id:b,customer_name:v,customer_address:j,inspection_date:R,inspection_type:k,status:S,roof_condition:E,notes:O,inspector:D}]);if(r){console.error("Error saving inspection:",r),r.message.includes('relation "inspections" does not exist')||r.message.includes("does not exist")||"42P01"===r.code?x("Inspeksjonstabellen eksisterer ikke enn\xe5. Vennligst kj\xf8r migrasjonen f\xf8rst."):x("Kunne ikke lagre inspeksjon: ".concat(r.message));return}if("utf\xf8rt"===S&&("v\xe5rvedlikehold"===k||"h\xf8stvedlikehold"===k)){let e="v\xe5rvedlikehold"===k?"var":"host",{error:r}=await a.ND.from("abonnementer").update({[e]:"Ja"}).eq("id",b);r&&console.error("Error updating customer maintenance status:",r)}A&&console.log("SMS would be sent:",{to:"customer phone",message:"Vi kommer for \xe5 utf\xf8re ".concat(k," p\xe5 taket ditt den ").concat(R)}),x("Inspeksjon lagret!"),setTimeout(()=>{e.push("/inspeksjoner")},1500)}catch(e){console.error("Unexpected error:",e),x("En uventet feil oppstod")}};return c?(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 p-8 ml-64",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-400",children:"Laster kunder..."})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 p-8 ml-64",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-white mb-6",children:"Ny inspeksjon"}),p&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-800 text-red-400 px-4 py-3 rounded-xl mb-6",children:p}),f&&!f.includes("Kunne ikke")&&!f.includes("Vennligst")&&(0,s.jsx)("div",{className:"bg-green-900/20 border border-green-800 text-green-400 px-4 py-3 rounded-xl mb-6",children:f}),f&&(f.includes("Kunne ikke")||f.includes("Vennligst"))&&(0,s.jsx)("div",{className:"bg-red-900/20 border border-red-800 text-red-400 px-4 py-3 rounded-xl mb-6",children:f}),(0,s.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,s.jsxs)(o.Zp,{className:"p-6 bg-gray-800 border border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Kundeinformasjon"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Velg kunde"}),(0,s.jsxs)("select",{className:"w-full p-2 border border-gray-600 rounded bg-gray-700 text-white",value:b,onChange:e=>{let t=e.target.value;if(h(t),t){let e=r.find(e=>e.id===t);e&&(y(e.etternavn),N(e.adresse))}else y(""),N("")},required:!0,children:[(0,s.jsx)("option",{value:"",children:"Velg kunde..."}),r.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.etternavn," - ",e.adresse,", ",e.kommune]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Type inspeksjon"}),(0,s.jsxs)("select",{className:"w-full p-2 border border-gray-600 rounded bg-gray-700 text-white",value:k,onChange:e=>w(e.target.value),required:!0,children:[(0,s.jsx)("option",{value:"",children:"Velg type..."}),(0,s.jsx)("option",{value:"v\xe5rvedlikehold",children:"V\xe5rvedlikehold"}),(0,s.jsx)("option",{value:"h\xf8stvedlikehold",children:"H\xf8stvedlikehold"}),(0,s.jsx)("option",{value:"rehabilitering",children:"Rehabilitering"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),(0,s.jsxs)("select",{className:"w-full p-2 border border-gray-600 rounded bg-gray-700 text-white",value:S,onChange:e=>C(e.target.value),children:[(0,s.jsx)("option",{value:"planlagt",children:"Planlagt"}),(0,s.jsx)("option",{value:"utf\xf8rt",children:"Utf\xf8rt"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Dato"}),(0,s.jsx)(d.p,{type:"date",value:R,onChange:e=>I(e.target.value),required:!0,className:"bg-gray-700 border-gray-600 text-white"})]})]})]}),(0,s.jsxs)(o.Zp,{className:"p-6 bg-gray-800 border border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Inspeksjonsdetaljer"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Taktilstand"}),(0,s.jsxs)("select",{className:"w-full p-2 border border-gray-600 rounded bg-gray-700 text-white",value:E,onChange:e=>V(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"Velg tilstand..."}),(0,s.jsx)("option",{value:"god",children:"God"}),(0,s.jsx)("option",{value:"normal",children:"Normal"}),(0,s.jsx)("option",{value:"d\xe5rlig",children:"D\xe5rlig"}),(0,s.jsx)("option",{value:"kritisk",children:"Kritisk"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Inspekt\xf8r"}),(0,s.jsx)(d.p,{type:"text",value:D,onChange:e=>U(e.target.value),placeholder:"Navn p\xe5 inspekt\xf8r",className:"bg-gray-700 border-gray-600 text-white"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Last opp bilder"}),(0,s.jsx)(d.p,{type:"file",accept:"image/*",multiple:!0,onChange:e=>{if(e.target.files){let r=Array.from(e.target.files);z(e=>[...e,...r]);let t=r.map(e=>URL.createObjectURL(e));T(e=>[...e,...t])}},className:"bg-gray-700 border-gray-600 text-white"}),K.length>0&&(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2 mt-2",children:K.map((e,r)=>(0,s.jsx)("img",{src:e,alt:"Bilde ".concat(r+1),className:"w-full h-24 object-cover rounded"},r))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Notater"}),(0,s.jsx)(u,{value:O,onChange:e=>_(e.target.value),placeholder:"Beskriv takets tilstand og eventuelle problemer...",rows:4,className:"bg-gray-700 border-gray-600 text-white"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"sendSms",checked:A,onChange:e=>J(e.target.checked),className:"rounded border-gray-600 bg-gray-700 text-blue-600"}),(0,s.jsxs)("label",{htmlFor:"sendSms",className:"text-gray-300",children:["Send SMS til kunde om ","planlagt"===S?"planlagt":"utf\xf8rt"," vedlikehold"]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(i.$,{type:"button",variant:"outline",onClick:()=>e.push("/inspeksjoner"),className:"border-gray-600 text-gray-300 hover:bg-gray-700",children:"Avbryt"}),(0,s.jsx)(i.$,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"planlagt"===S?"Planlegg inspeksjon":"Registrer utf\xf8rt inspeksjon"})]})]})]})})}u.displayName="Textarea"},9434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>l});var s=t(2596),n=t(9688);function l(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.QP)((0,s.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[851,635,441,684,358],()=>r(7256)),_N_E=e.O()}]);
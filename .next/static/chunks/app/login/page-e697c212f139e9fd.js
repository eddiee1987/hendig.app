(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2099:(e,r,a)=>{"use strict";a.d(r,{HK:()=>i,LY:()=>u,ND:()=>s,qi:()=>c,y9:()=>o});var t=a(851);let l="https://jntsodzdafscwksizfov.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",l),console.log("Supabase Anon Key:",n?"Set":"Not set"),l&&n||console.error("Supabase credentials are not set correctly in environment variables");let s=(0,t.UU)(l,n);async function o(){try{let{data:e,error:r}=await s.from("lager").select("navn, antall");if(r)return console.error("Error fetching lager:",r),{};let a={};return null==e||e.forEach(e=>{a[e.navn.toLowerCase().replaceAll(" ","_").replaceAll("\xe5","a").replaceAll("\xe6","ae").replaceAll("\xf8","o")]=e.antall}),a}catch(e){return console.error("Unexpected error fetching lager:",e),{}}}async function i(e){try{let{data:r,error:a}=await s.from("lager").select("id, navn");if(a)return void console.error("Error fetching lager for update:",a);for(let[a,t]of Object.entries(e)){let e=a.replaceAll("_"," ").replaceAll("ae","\xe6").replaceAll("o","\xf8").replaceAll("a","\xe5"),l=null==r?void 0:r.find(e=>e.navn.toLowerCase().replaceAll(" ","_")===a);l?await s.from("lager").update({antall:Number(t)}).eq("id",l.id):await s.from("lager").insert([{navn:e,antall:Number(t)}])}}catch(e){console.error("Unexpected error updating lager:",e)}}async function c(){try{let{data:e,error:r}=await s.from("lager_transactions").select("created_at, type, antall, kommentar, lager_id, lager:lager_id(navn)").order("created_at",{ascending:!1}).limit(100);if(r)return console.error("Error fetching lager historikk:",r),window.__supabaseLagerHistorikkError=r,[];return(e||[]).map(e=>{var r,a;return{created_at:e.created_at,navn:(null==(a=e.lager)||null==(r=a[0])?void 0:r.navn)||"",type:e.type,antall:e.antall,kommentar:e.kommentar||""}})}catch(e){return console.error("Unexpected error fetching lager historikk:",e),[]}}async function u(e){let{key:r,type:a,antall:t,kommentar:l}=e;try{let e=r.replaceAll("_"," ").replaceAll("ae","\xe6").replaceAll("o","\xf8").replaceAll("a","\xe5"),n=null,o=0,{data:i}=await s.from("lager").select("id, antall").eq("navn",e).limit(1);if(i&&0!==i.length){if(n=i[0].id,o=i[0].antall,"inntak"===a)o+=t;else if("uttak"===a){if(i[0].antall<t)return{error:"Ikke nok p\xe5 lager for uttak"};o-=t}else"manuell"===a&&(o=t);let{error:e}=await s.from("lager").update({antall:o}).eq("id",n);if(e)return{error:"Kunne ikke oppdatere lagerbeholdning"}}else{if("manuell"!==a)return{error:"Fant ikke varen i lageret"};let{data:r,error:l}=await s.from("lager").insert([{navn:e,antall:Number(t)}]).select("id").single();if(l||!r)return{error:"Kunne ikke opprette ny vare"};n=r.id,o=Number(t)}let{error:c}=await s.from("lager_transactions").insert({lager_id:n,type:a,antall:t,kommentar:l});if(c)return{error:"Kunne ikke registrere transaksjon"};return{success:!0}}catch(e){return{error:"Uventet feil ved registrering"}}}},5695:(e,r,a)=>{"use strict";var t=a(8999);a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})},8043:(e,r,a)=>{Promise.resolve().then(a.bind(a,9690))},9690:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>o});var t=a(5155),l=a(2115),n=a(5695),s=a(2099);function o(){let[e,r]=(0,l.useState)(""),[a,o]=(0,l.useState)(""),[i,c]=(0,l.useState)(""),[u,d]=(0,l.useState)(!1),g=(0,n.useRouter)(),m=async r=>{r.preventDefault(),d(!0),c("");let{error:t}=await s.ND.auth.signInWithPassword({email:e,password:a});d(!1),t?c(t.message):g.push("/dashboard")},p=async r=>{r.preventDefault(),d(!0),c("");let{error:t}=await s.ND.auth.signUp({email:e,password:a});d(!1),t?c(t.message):g.push("/dashboard")};return(0,t.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-950 relative overflow-hidden",children:[(0,t.jsx)("img",{src:"https://images.unsplash.com/photo-1618090584176-7132b9911657?q=80&w=1828&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"H\xe5ndverker bakgrunn",className:"absolute inset-0 w-full h-full object-cover opacity-40 z-0","aria-hidden":"true"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gray-950/70 z-10","aria-hidden":"true"}),(0,t.jsxs)("form",{onSubmit:m,className:"relative z-20 bg-gray-900 p-8 rounded-xl shadow-lg w-full max-w-sm border border-gray-800",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center text-gray-100",children:"Logg inn"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block mb-1 text-gray-300",children:"E-post"}),(0,t.jsx)("input",{type:"email",value:e,onChange:e=>r(e.target.value),className:"w-full px-3 py-2 border border-gray-700 rounded bg-gray-800 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-600",required:!0,placeholder:"din@email.no"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block mb-1 text-gray-300",children:"Passord"}),(0,t.jsx)("input",{type:"password",value:a,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-700 rounded bg-gray-800 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-600",required:!0,placeholder:"••••••••"})]}),i&&(0,t.jsx)("div",{className:"mb-4 text-red-400 text-sm",children:i}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed font-semibold mt-2",disabled:u,children:u?"Logger inn...":"Logg inn"}),(0,t.jsx)("button",{type:"button",onClick:p,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition-colors disabled:opacity-60 disabled:cursor-not-allowed font-semibold mt-2",disabled:u,children:u?"Oppretter bruker...":"Opprett bruker"})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[851,441,684,358],()=>r(8043)),_N_E=e.O()}]);
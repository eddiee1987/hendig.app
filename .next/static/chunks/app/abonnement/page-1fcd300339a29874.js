(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[876],{2099:(e,t,s)=>{"use strict";s.d(t,{ND:()=>l,uT:()=>o});var r=s(851);let n="https://jntsodzdafscwksizfov.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",n),console.log("Supabase Anon Key:",a?"Set":"Not set"),n&&a||console.error("Supabase credentials are not set correctly in environment variables");let l=(0,r.UU)(n,a);async function o(e){try{let{data:t,error:s}=await l.from("time_entries").select("*").eq("employee_id",e).order("date",{ascending:!1});if(s)return console.error("Error fetching time entries:",s),[];return t}catch(e){return console.error("Unexpected error fetching time entries:",e),[]}}},2383:()=>{},3399:(e,t,s)=>{Promise.resolve().then(s.bind(s,6696))},3686:()=>{},6696:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),n=s(2115),a=s(2099),l=s(3925),o=s(3568),i=s(9684);function d(e){let{onImportSuccess:t}=e,[s,a]=(0,n.useState)(!1),[d,c]=(0,n.useState)(0),[m,x]=(0,n.useState)(0),[h,u]=(0,n.useState)(0),b=async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){a(!0),c(0),u(0);try{let t=await g(s);if(0===t.length){o.oR.error("Ingen data funnet i filen"),a(!1);return}x(t.length),await j(t),o.oR.success("".concat(t.length," abonnementer importert")),e.target.value=""}catch(e){console.error("Error importing abonnements:",e),o.oR.error("Kunne ikke importere abonnementer")}finally{a(!1)}}},g=e=>new Promise((t,s)=>{let r=new FileReader;r.onload=e=>{try{var r;let s=null==(r=e.target)?void 0:r.result,n=l.LF(s,{type:"binary"}),a=n.SheetNames[0],o=n.Sheets[a],i=l.Wp.sheet_to_json(o).map(e=>({fornavn:e.Fornavn||"",etternavn:e.Etternavn||"",adresse:e.Adresse||"",kommune:e.Kommune||"",var_utfort:!!e["V\xe5r"],host_utfort:!!e["H\xf8st"],epost:e["E-post"]||"",fakturert:!!e.Fakturert,fornyelsesdato:e.Fornyelsesdato?p(e.Fornyelsesdato):"",sum:Number(e.Sum)||0,notat:e.Notat||""}));t(i)}catch(e){s(e)}},r.onerror=e=>s(e),r.readAsBinaryString(e)}),p=e=>{if("number"==typeof e)return new Date(new Date(1900,0,1).getTime()+(e-1)*864e5).toISOString().split("T")[0];if("string"==typeof e){let t=e.split(".");if(3===t.length)return"".concat(t[2],"-").concat(t[1].padStart(2,"0"),"-").concat(t[0].padStart(2,"0"))}return""},j=async e=>{for(let t=0;t<e.length;t++){let s=e[t];try{await (0,i.CL)({fornavn:s.fornavn,etternavn:s.etternavn,adresse:s.adresse,kommune:s.kommune,var:s.var_utfort?"utf\xf8rt":"ikke utf\xf8rt",host:s.host_utfort?"utf\xf8rt":"ikke utf\xf8rt",epost:s.epost,fakturert:s.fakturert,fornyelsesdato:s.fornyelsesdato,sum:s.sum,notat:s.notat}),u(t+1),c(Math.round((t+1)/e.length*100))}catch(e){console.error("Error creating abonnement ".concat(s.etternavn,":"),e)}}t&&t()};return(0,r.jsxs)("div",{className:"bg-gray-900 rounded-xl border border-gray-800 p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Importer abonnementer"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("p",{className:"text-gray-400 mb-2",children:"Last opp en Excel-fil med abonnementer. Filen m\xe5 inneholde f\xf8lgende kolonner:"}),(0,r.jsxs)("ul",{className:"text-gray-400 text-sm list-disc pl-5 mb-4",children:[(0,r.jsx)("li",{children:"Fornavn"}),(0,r.jsx)("li",{children:"Etternavn"}),(0,r.jsx)("li",{children:"Adresse"}),(0,r.jsx)("li",{children:"Kommune"}),(0,r.jsx)("li",{children:"V\xe5r (sjekkboks)"}),(0,r.jsx)("li",{children:"H\xf8st (sjekkboks)"}),(0,r.jsx)("li",{children:"E-post"}),(0,r.jsx)("li",{children:"Fakturert (sjekkboks)"}),(0,r.jsx)("li",{children:"Fornyelsesdato"}),(0,r.jsx)("li",{children:"Sum"}),(0,r.jsx)("li",{children:"Notat"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block mb-2 text-sm font-medium text-white",children:"Velg Excel-fil"}),(0,r.jsx)("input",{type:"file",accept:".xlsx, .xls",onChange:b,disabled:s,className:"block w-full text-sm text-gray-400 border border-gray-700 rounded-lg cursor-pointer bg-gray-800 focus:outline-none"})]}),s&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-white",children:"Importerer..."}),(0,r.jsxs)("span",{className:"text-sm font-medium text-white",children:[d,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(d,"%")}})}),(0,r.jsxs)("p",{className:"text-sm text-gray-400 mt-2",children:[h," av ",m," abonnementer importert"]})]})]})}function c(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)(!0),[o,i]=(0,n.useState)(null),[c,m]=(0,n.useState)(""),[x,h]=(0,n.useState)(!1),[u,b]=(0,n.useState)({etternavn:"",adresse:"",kommune:"",fornyelsesdato:"",tak_storrelse:""}),[g,p]=(0,n.useState)(""),[j,f]=(0,n.useState)(null),[y,v]=(0,n.useState)("kontakt"),[N,k]=(0,n.useState)(!1),[w,C]=(0,n.useState)(null),[S,_]=(0,n.useState)([]),[F,L]=(0,n.useState)(!1),[E,I]=(0,n.useState)(!1),[D,A]=(0,n.useState)([]),[K,M]=(0,n.useState)(!1),[B]=(0,n.useState)([{dato:"2025-01-15",belop:2500,status:"betalt"},{dato:"2024-07-20",belop:2500,status:"betalt"},{dato:"2024-01-15",belop:2300,status:"betalt"},{dato:"2023-07-20",belop:2300,status:"betalt"}]),[O]=(0,n.useState)([{dato:"2025-03-10",utfort_av:"Ole Hansen",kommentar:"Alt ser bra ut",status:"godkjent"},{dato:"2024-09-05",utfort_av:"Kari Olsen",kommentar:"Noen omr\xe5der trenger ekstra vedlikehold",status:"mangler"},{dato:"2024-03-12",utfort_av:"Ole Hansen",kommentar:"Fikset mangler fra forrige inspeksjon",status:"godkjent"},{dato:"2023-09-08",utfort_av:"Kari Olsen",kommentar:"Alt ser bra ut",status:"godkjent"}]),[H]=(0,n.useState)([{dato:"2025-03-10",ansatt:"Ole Hansen",varighet:"2 timer",kommentar:"Vanlig vedlikehold"},{dato:"2024-09-05",ansatt:"Kari Olsen",varighet:"3 timer",kommentar:"Ekstra arbeid p\xe5 nordside"},{dato:"2024-03-12",ansatt:"Ole Hansen",varighet:"2 timer",kommentar:"Vanlig vedlikehold"},{dato:"2023-09-08",ansatt:"Kari Olsen",varighet:"2 timer",kommentar:"Vanlig vedlikehold"}]);async function U(e){try{console.log("Henter abonnementer...");let s=a.ND.from("abonnementer").select("*");e&&(s=s.or("etternavn.ilike.%".concat(e,"%,adresse.ilike.%").concat(e,"%,kommune.ilike.%").concat(e,"%")));let{data:r,error:n}=await s;if(n)throw console.error("Supabase error:",n),n;console.log("Mottatt data:",r),t(r||[])}catch(e){console.error("Fetch error:",e),i("Kunne ikke hente abonnementer")}finally{l(!1)}}(0,n.useEffect)(()=>{U()},[]);let V=e=>{let{name:t,value:s}=e.target;b(e=>({...e,[t]:s}))},z=async e=>{e.preventDefault();try{p("Lagrer ny kunde...");let e={etternavn:u.etternavn,adresse:u.adresse,kommune:u.kommune,fornyelsesdato:u.fornyelsesdato,tak_storrelse:u.tak_storrelse,sted:"",var:"",host:"",epost:"",fakturert:"",mail_var:"",mail_host:"",tidsbruk_slatt:"",sum:"",notat:""},{error:t}=await a.ND.from("abonnementer").insert([e]);if(t)throw console.error("Supabase insert error:",t),t;b({etternavn:"",adresse:"",kommune:"",fornyelsesdato:"",tak_storrelse:""}),p("Kunde lagt til!"),h(!1),U(),setTimeout(()=>{p("")},3e3)}catch(e){console.error("Submit error:",e),p("Kunne ikke lagre ny kunde")}};return s?(0,r.jsxs)("div",{className:"text-center text-white",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"}),(0,r.jsx)("p",{className:"mt-4",children:"Laster abonnementer..."})]}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"text-center mb-12",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white mb-4",children:"Vedlikeholdsabonnementer"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Administrer torvtak vedlikeholdsabonnementer"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(d,{onImportSuccess:U})}),(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-white",children:o?"Feil ved lasting av abonnementer":"Abonnementer"}),(0,r.jsxs)("div",{className:"relative w-64",children:[(0,r.jsx)("input",{type:"text",placeholder:"S\xf8k i kunder...",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:e=>{U(e.target.value.toLowerCase())}}),(0,r.jsx)("svg",{className:"absolute right-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center ".concat(0===S.length?"opacity-50 cursor-not-allowed":""),onClick:()=>{S.length>0&&I(!0)},disabled:0===S.length,children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Slett (",S.length,")"]}),(0,r.jsx)("button",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",onClick:()=>{L(!1),_([])},children:"Avbryt"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center",onClick:()=>L(!0),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Slett kunder"]}),(0,r.jsxs)("button",{className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",onClick:()=>h(!0),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Legg til ny kunde"]})]})})]}),o?(0,r.jsx)("p",{className:"text-red-500",children:o}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-400 border-b border-gray-700",children:[F&&(0,r.jsx)("th",{className:"pb-3 w-10",children:(0,r.jsx)("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500",onChange:t=>{t.target.checked?_(e.filter(e=>e.id).map(e=>e.id)):_([])},checked:S.length===e.filter(e=>e.id).length&&e.length>0})}),(0,r.jsx)("th",{className:"pb-3",children:"Navn"}),(0,r.jsx)("th",{className:"pb-3",children:"Adresse"}),(0,r.jsx)("th",{className:"pb-3",children:"Kommune"}),(0,r.jsx)("th",{className:"pb-3",children:"V\xe5r"}),(0,r.jsx)("th",{className:"pb-3",children:"H\xf8st"}),(0,r.jsx)("th",{className:"pb-3",children:"Fornyelsesdato"}),(0,r.jsx)("th",{className:"pb-3",children:"Status"})]})}),(0,r.jsx)("tbody",{children:e.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-gray-700 text-gray-300 hover:bg-gray-700 cursor-pointer transition-colors",onClick:t=>{F?"INPUT"!==t.target.tagName&&(t.preventDefault(),e.id&&(S.includes(e.id)?_(t=>t.filter(t=>t!==e.id)):_(t=>[...t,e.id]))):f(e)},children:[F&&(0,r.jsx)("td",{className:"py-3 pl-3",children:(0,r.jsx)("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500",checked:!!e.id&&S.includes(e.id),onChange:t=>{e.id&&(t.target.checked?_(t=>[...t,e.id]):_(t=>t.filter(t=>t!==e.id)))},onClick:e=>e.stopPropagation()})}),(0,r.jsx)("td",{className:"py-3",children:e.etternavn}),(0,r.jsx)("td",{className:"py-3",children:e.adresse}),(0,r.jsx)("td",{className:"py-3",children:e.kommune||"-"}),(0,r.jsx)("td",{className:"py-3",children:e.var}),(0,r.jsx)("td",{className:"py-3",children:e.host}),(0,r.jsx)("td",{className:"py-3",children:e.fornyelsesdato}),(0,r.jsx)("td",{className:"py-3",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-green-900/20 text-green-400",children:"Aktiv"})})]},t))})]})})]}),j&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-white",children:j.etternavn}),(0,r.jsx)("button",{onClick:()=>f(null),className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"flex border-b border-gray-700 mb-6",children:[(0,r.jsx)("button",{className:"px-4 py-2 font-medium ".concat("betalinger"===y?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),onClick:()=>v("betalinger"),children:"Betalinger"}),(0,r.jsx)("button",{className:"px-4 py-2 font-medium ".concat("inspeksjoner"===y?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),onClick:()=>v("inspeksjoner"),children:"Inspeksjoner"}),(0,r.jsx)("button",{className:"px-4 py-2 font-medium ".concat("besok"===y?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),onClick:()=>v("besok"),children:"Bes\xf8k"}),(0,r.jsx)("button",{className:"px-4 py-2 font-medium ".concat("kontakt"===y?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"),onClick:()=>v("kontakt"),children:"Kontaktinfo"})]}),(0,r.jsxs)("div",{children:["betalinger"===y&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-white",children:"Betalingshistorikk"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Registrer ny betaling"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-400 border-b border-gray-700",children:[(0,r.jsx)("th",{className:"pb-2",children:"Dato"}),(0,r.jsx)("th",{className:"pb-2",children:"Bel\xf8p"}),(0,r.jsx)("th",{className:"pb-2",children:"Status"})]})}),(0,r.jsx)("tbody",{children:B.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-gray-700 text-gray-300",children:[(0,r.jsx)("td",{className:"py-3",children:e.dato}),(0,r.jsxs)("td",{className:"py-3",children:[e.belop," kr"]}),(0,r.jsx)("td",{className:"py-3",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("betalt"===e.status?"bg-green-900/20 text-green-400":"ubetalt"===e.status?"bg-yellow-900/20 text-yellow-400":"bg-red-900/20 text-red-400"),children:"betalt"===e.status?"Betalt":"ubetalt"===e.status?"Ubetalt":"Forsinket"})})]},t))})]})})]}),"inspeksjoner"===y&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-white",children:"Inspeksjonshistorikk"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Registrer ny inspeksjon"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-400 border-b border-gray-700",children:[(0,r.jsx)("th",{className:"pb-2",children:"Dato"}),(0,r.jsx)("th",{className:"pb-2",children:"Utf\xf8rt av"}),(0,r.jsx)("th",{className:"pb-2",children:"Kommentar"}),(0,r.jsx)("th",{className:"pb-2",children:"Status"})]})}),(0,r.jsx)("tbody",{children:O.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-gray-700 text-gray-300",children:[(0,r.jsx)("td",{className:"py-3",children:e.dato}),(0,r.jsx)("td",{className:"py-3",children:e.utfort_av}),(0,r.jsx)("td",{className:"py-3",children:e.kommentar}),(0,r.jsx)("td",{className:"py-3",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("godkjent"===e.status?"bg-green-900/20 text-green-400":"bg-yellow-900/20 text-yellow-400"),children:"godkjent"===e.status?"Godkjent":"Mangler"})})]},t))})]})})]}),"besok"===y&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-white",children:"Bes\xf8kshistorikk"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Registrer nytt bes\xf8k"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-400 border-b border-gray-700",children:[(0,r.jsx)("th",{className:"pb-2",children:"Dato"}),(0,r.jsx)("th",{className:"pb-2",children:"Ansatt"}),(0,r.jsx)("th",{className:"pb-2",children:"Varighet"}),(0,r.jsx)("th",{className:"pb-2",children:"Kommentar"})]})}),(0,r.jsx)("tbody",{children:H.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-gray-700 text-gray-300",children:[(0,r.jsx)("td",{className:"py-3",children:e.dato}),(0,r.jsx)("td",{className:"py-3",children:e.ansatt}),(0,r.jsx)("td",{className:"py-3",children:e.varighet}),(0,r.jsx)("td",{className:"py-3",children:e.kommentar})]},t))})]})})]}),"kontakt"===y&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h4",{className:"text-lg font-medium text-white",children:"Kontaktinformasjon"}),N?(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{className:"px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm",onClick:()=>{k(!1),C(null)},children:"Avbryt"}),(0,r.jsx)("button",{className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-sm",onClick:async()=>{if(w)try{let{error:e}=await a.ND.from("abonnementer").update({etternavn:w.etternavn,adresse:w.adresse,kommune:w.kommune,epost:w.epost,fornyelsesdato:w.fornyelsesdato,tak_storrelse:w.tak_storrelse,notat:w.notat}).eq("id",w.id);if(e)throw console.error("Update error:",e),e;f(w),k(!1),U()}catch(e){console.error("Update error:",e)}},children:"Lagre"})]}):(0,r.jsx)("button",{className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",onClick:()=>{k(!0),C(j)},children:"Rediger"})]}),N?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-etternavn",className:"block text-sm font-medium text-gray-400 mb-1",children:"Navn"}),(0,r.jsx)("input",{type:"text",id:"edit-etternavn",value:(null==w?void 0:w.etternavn)||"",onChange:e=>{w&&C({...w,etternavn:e.target.value})},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-adresse",className:"block text-sm font-medium text-gray-400 mb-1",children:"Adresse"}),(0,r.jsx)("input",{type:"text",id:"edit-adresse",value:(null==w?void 0:w.adresse)||"",onChange:e=>{w&&C({...w,adresse:e.target.value})},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-kommune",className:"block text-sm font-medium text-gray-400 mb-1",children:"Kommune"}),(0,r.jsx)("input",{type:"text",id:"edit-kommune",value:(null==w?void 0:w.kommune)||"",onChange:e=>{w&&C({...w,kommune:e.target.value})},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-epost",className:"block text-sm font-medium text-gray-400 mb-1",children:"E-post"}),(0,r.jsx)("input",{type:"email",id:"edit-epost",value:(null==w?void 0:w.epost)||"",onChange:e=>{w&&C({...w,epost:e.target.value})},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-fornyelsesdato",className:"block text-sm font-medium text-gray-400 mb-1",children:"Fornyelsesdato"}),(0,r.jsx)("input",{type:"date",id:"edit-fornyelsesdato",value:(null==w?void 0:w.fornyelsesdato)||"",onChange:e=>{w&&C({...w,fornyelsesdato:e.target.value})},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-tak_storrelse",className:"block text-sm font-medium text-gray-400 mb-1",children:"Takst\xf8rrelse"}),(0,r.jsx)("input",{type:"text",id:"edit-tak_storrelse",value:(null==w?void 0:w.tak_storrelse)||"",onChange:e=>{w&&C({...w,tak_storrelse:e.target.value})},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"f.eks. 120 m\xb2"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"edit-notat",className:"block text-sm font-medium text-gray-400 mb-1",children:"Notat"}),(0,r.jsx)("textarea",{id:"edit-notat",value:(null==w?void 0:w.notat)||"",onChange:e=>{w&&C({...w,notat:e.target.value})},rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}):(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"Navn"}),(0,r.jsx)("p",{className:"text-white",children:j.etternavn})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"Adresse"}),(0,r.jsx)("p",{className:"text-white",children:j.adresse})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"Kommune"}),(0,r.jsx)("p",{className:"text-white",children:j.kommune||"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"E-post"}),(0,r.jsx)("p",{className:"text-white",children:j.epost||"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"Fornyelsesdato"}),(0,r.jsx)("p",{className:"text-white",children:j.fornyelsesdato||"-"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"Takst\xf8rrelse"}),(0,r.jsx)("p",{className:"text-white",children:j.tak_storrelse||"-"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-gray-400 mb-1",children:"Notat"}),(0,r.jsx)("p",{className:"text-white",children:j.notat||"-"})]})]})]})]})]})}),E&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Bekreft sletting"}),(0,r.jsx)("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("p",{className:"text-white mb-2",children:["Er du sikker p\xe5 at du vil slette ",S.length," kunde",1!==S.length?"r":"","?"]}),(0,r.jsx)("p",{className:"text-gray-400 text-sm",children:"Dette kan ikke angres."})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>I(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Avbryt"}),(0,r.jsx)("button",{type:"button",onClick:async()=>{try{let{error:e}=await a.ND.from("abonnementer").delete().in("id",S);if(e)throw console.error("Delete error:",e),e;I(!1),L(!1),_([]),U()}catch(e){console.error("Delete error:",e)}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Slett"})]})]})}),K&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Potensielle duplikater funnet"}),(0,r.jsx)("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("p",{className:"text-white mb-2",children:"F\xf8lgende kunder i importfilen kan v\xe6re duplikater av eksisterende kunder:"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:"Vennligst gjennomg\xe5 listen og bekreft om du vil fortsette med importen."}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-400 border-b border-gray-700",children:[(0,r.jsx)("th",{className:"pb-3",children:"Ny kunde"}),(0,r.jsx)("th",{className:"pb-3",children:"Eksisterende kunde"}),(0,r.jsx)("th",{className:"pb-3",children:"\xc5rsak"})]})}),(0,r.jsx)("tbody",{children:D.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-gray-700 text-gray-300",children:[(0,r.jsxs)("td",{className:"py-3",children:[(0,r.jsx)("div",{className:"font-medium",children:e.customer.etternavn}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:e.customer.adresse})]}),(0,r.jsxs)("td",{className:"py-3",children:[(0,r.jsx)("div",{className:"font-medium",children:e.existingCustomer.etternavn}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:e.existingCustomer.adresse})]}),(0,r.jsx)("td",{className:"py-3",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-yellow-900/20 text-yellow-400",children:e.reason})})]},t))})]})})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{M(!1),m("")},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Avbryt import"}),(0,r.jsx)("button",{type:"button",onClick:async()=>{try{let e=D.map(e=>e.customer),{error:t}=await a.ND.from("abonnementer").insert(e);if(t){console.error("Supabase insert error:",t),m("Import feilet: ".concat(t.message||"Ukjent feil"));return}m("Import fullf\xf8rt! ".concat(e.length," abonnementer lagt til.")),M(!1),U()}catch(e){console.error("Import error:",e),m("Import feilet: Kunne ikke legge til abonnementer")}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Fortsett import likevel"})]})]})}),x&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 w-full max-w-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-white",children:"Legg til ny kunde"}),(0,r.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("form",{onSubmit:z,children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"etternavn",className:"block text-sm font-medium text-gray-400 mb-1",children:"Navn"}),(0,r.jsx)("input",{type:"text",id:"etternavn",name:"etternavn",value:u.etternavn,onChange:V,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"adresse",className:"block text-sm font-medium text-gray-400 mb-1",children:"Adresse"}),(0,r.jsx)("input",{type:"text",id:"adresse",name:"adresse",value:u.adresse,onChange:V,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"kommune",className:"block text-sm font-medium text-gray-400 mb-1",children:"Kommune"}),(0,r.jsx)("input",{type:"text",id:"kommune",name:"kommune",value:u.kommune,onChange:V,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"fornyelsesdato",className:"block text-sm font-medium text-gray-400 mb-1",children:"Fornyelsesdato"}),(0,r.jsx)("input",{type:"date",id:"fornyelsesdato",name:"fornyelsesdato",value:u.fornyelsesdato,onChange:V,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"tak_storrelse",className:"block text-sm font-medium text-gray-400 mb-1",children:"St\xf8rrelse p\xe5 tak"}),(0,r.jsx)("input",{type:"text",id:"tak_storrelse",name:"tak_storrelse",value:u.tak_storrelse,onChange:V,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"f.eks. 120 m\xb2"})]})]}),g&&(0,r.jsx)("p",{className:"mt-4 ".concat(g.includes("ikke")?"text-red-500":"text-green-500"),children:g}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Avbryt"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Lagre"})]})]})]})})]})}},9684:(e,t,s)=>{"use strict";s.d(t,{CL:()=>i,NA:()=>o,R2:()=>n,lt:()=>l,s2:()=>a});var r=s(2099);async function n(){let{data:e,error:t}=await r.ND.from("abonnementer").select("*").order("etternavn",{ascending:!0});if(t)throw console.error("Error fetching abonnements:",t),t;return e||[]}async function a(){let{data:e,error:t}=await r.ND.from("scheduled_abonnements").select("\n      *,\n      abonnementer:abonnement_id (*)\n    ").order("scheduled_date",{ascending:!0});if(t)throw console.error("Error fetching scheduled abonnements:",t),t;return e||[]}async function l(e,t){try{let s=Number(e);if(isNaN(s))throw Error("Invalid abonnement ID: ".concat(e));if(!t||!Date.parse(t))throw Error("Invalid date format: ".concat(t));let{data:n,error:a}=await r.ND.from("scheduled_abonnements").insert([{abonnement_id:s,scheduled_date:t}]).select();if(a)throw console.error("Error scheduling abonnement ".concat(e," for date ").concat(t,":"),{message:a.message,code:a.code,details:a.details,hint:a.hint}),Error("Failed to schedule: ".concat(a.message));if(!n||0===n.length)throw Error("No data returned from scheduling operation");return n[0]}catch(t){throw console.error("Failed to schedule abonnement ".concat(e,":"),{error:t instanceof Error?t.message:t,stack:t instanceof Error?t.stack:void 0}),Error("Failed to schedule abonnement: ".concat(t instanceof Error?t.message:"Unknown error"))}}async function o(e,t){let{error:s}=await r.ND.from("scheduled_abonnements").delete().eq("abonnement_id",e).eq("scheduled_date",t);if(s)throw console.error("Error unscheduling abonnement ".concat(e," for date ").concat(t,":"),s),s;return!0}async function i(e){let{data:t,error:s}=await r.ND.from("abonnementer").insert([{fornavn:e.fornavn,etternavn:e.etternavn,adresse:e.adresse,kommune:e.kommune,var:e.var,host:e.host,epost:e.epost,fakturert:e.fakturert,fornyelsesdato:e.fornyelsesdato,sum:e.sum,notat:e.notat}]).select();if(s)throw console.error("Error creating abonnement:",s),s;return null==t?void 0:t[0]}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,851,568,441,684,358],()=>t(3399)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1846:(e,t,r)=>{Promise.resolve().then(r.bind(r,7486))},2099:(e,t,r)=>{"use strict";r.d(t,{HK:()=>o,LY:()=>d,ND:()=>n,qi:()=>c,y9:()=>i});var s=r(851);let a="https://jntsodzdafscwksizfov.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",a),console.log("Supabase Anon Key:",l?"Set":"Not set"),a&&l||console.error("Supabase credentials are not set correctly in environment variables");let n=(0,s.UU)(a,l);async function i(){try{let{data:e,error:t}=await n.from("lager").select("navn, antall");if(t)return console.error("Error fetching lager:",t),{};let r={};return null==e||e.forEach(e=>{r[e.navn.toLowerCase().replaceAll(" ","_").replaceAll("\xe5","a").replaceAll("\xe6","ae").replaceAll("\xf8","o")]=e.antall}),r}catch(e){return console.error("Unexpected error fetching lager:",e),{}}}async function o(e){try{let{data:t,error:r}=await n.from("lager").select("id, navn");if(r)return void console.error("Error fetching lager for update:",r);for(let[r,s]of Object.entries(e)){let e=r.replaceAll("_"," ").replaceAll("ae","\xe6").replaceAll("o","\xf8").replaceAll("a","\xe5"),a=null==t?void 0:t.find(e=>e.navn.toLowerCase().replaceAll(" ","_")===r);a?await n.from("lager").update({antall:Number(s)}).eq("id",a.id):await n.from("lager").insert([{navn:e,antall:Number(s)}])}}catch(e){console.error("Unexpected error updating lager:",e)}}async function c(){try{let{data:e,error:t}=await n.from("lager_transactions").select("created_at, type, antall, kommentar, lager_id, lager:lager_id(navn)").order("created_at",{ascending:!1}).limit(100);if(t)return console.error("Error fetching lager historikk:",t),window.__supabaseLagerHistorikkError=t,[];return(e||[]).map(e=>{var t,r;return{created_at:e.created_at,navn:(null==(r=e.lager)||null==(t=r[0])?void 0:t.navn)||"",type:e.type,antall:e.antall,kommentar:e.kommentar||""}})}catch(e){return console.error("Unexpected error fetching lager historikk:",e),[]}}async function d(e){let{key:t,type:r,antall:s,kommentar:a}=e;try{let e=t.replaceAll("_"," ").replaceAll("ae","\xe6").replaceAll("o","\xf8").replaceAll("a","\xe5"),l=null,i=0,{data:o}=await n.from("lager").select("id, antall").eq("navn",e).limit(1);if(o&&0!==o.length){if(l=o[0].id,i=o[0].antall,"inntak"===r)i+=s;else if("uttak"===r){if(o[0].antall<s)return{error:"Ikke nok p\xe5 lager for uttak"};i-=s}else"manuell"===r&&(i=s);let{error:e}=await n.from("lager").update({antall:i}).eq("id",l);if(e)return{error:"Kunne ikke oppdatere lagerbeholdning"}}else{if("manuell"!==r)return{error:"Fant ikke varen i lageret"};let{data:t,error:a}=await n.from("lager").insert([{navn:e,antall:Number(s)}]).select("id").single();if(a||!t)return{error:"Kunne ikke opprette ny vare"};l=t.id,i=Number(s)}let{error:c}=await n.from("lager_transactions").insert({lager_id:l,type:r,antall:s,kommentar:a});if(c)return{error:"Kunne ikke registrere transaksjon"};return{success:!0}}catch(e){return{error:"Uventet feil ved registrering"}}}},7486:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(5155),a=r(2115),l=r(6874),n=r.n(l),i=r(2099);async function o(e){let t="7755843cdee3787c0c51687458acae46";if(!t)throw Error("OpenWeather API key not configured");let r=await fetch("https://api.openweathermap.org/data/2.5/forecast?q=".concat(e,"&units=metric&appid=").concat(t)),s=await r.json();if(!r.ok)throw Error(s.message||"Failed to fetch weather data");return s.list.reduce((e,t)=>{let r=t.dt_txt.split(" ")[0];return e.find(e=>e.dt_txt.includes(r))||e.push(t),e},[]).map(e=>({date:e.dt_txt,temp:e.main.temp,description:e.weather[0].description,icon:e.weather[0].icon}))}function c(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[n,i]=(0,a.useState)("");return((0,a.useEffect)(()=>{(async()=>{try{let e=await o("Nesbyen,NO");t(e.slice(0,7))}catch(e){i(e instanceof Error?e.message:"Failed to load weather")}finally{l(!1)}})()},[]),r)?(0,s.jsx)("div",{children:"Loading weather..."}):n?(0,s.jsx)("div",{className:"text-red-500",children:n}):(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow p-4 border border-gray-700",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2 text-white",children:"V\xe6rvarsel for Nesbyen"}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-4 xl:gap-6",children:e.map(e=>(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-sm text-gray-300",children:new Date(e.date).toLocaleDateString("no-NO",{weekday:"short"})}),(0,s.jsx)("img",{src:"https://openweathermap.org/img/wn/".concat(e.icon,".png"),alt:e.description,className:"mx-auto"}),(0,s.jsxs)("div",{className:"font-medium text-white",children:[Math.round(e.temp),"\xb0C"]})]},e.date))})]})}var d=r(7794),m=r(1756),h=r(8794),x=r(2736);function u(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[n,i]=(0,a.useState)("");return((0,a.useEffect)(()=>{(async()=>{try{let e=(await (0,d.ui)()).filter(e=>(0,m.R)((0,h.H)(e.scheduled_date),new Date));t(e)}catch(e){i(e instanceof Error?e.message:"Failed to load maintenance schedule")}finally{l(!1)}})()},[]),r)?(0,s.jsx)("div",{children:"Loading maintenance schedule..."}):n?(0,s.jsx)("div",{className:"text-red-500",children:n}):(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow p-4 border border-gray-700 mt-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2 text-white",children:"Planlagt vedlikehold denne uken"}),0===e.length?(0,s.jsx)("div",{className:"text-gray-300",children:"Du har ingen planlagte jobber denne uken"}):(0,s.jsx)("div",{className:"space-y-2",children:e.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("div",{className:"text-white",children:(null==(t=e.projects)?void 0:t.name)||"Ukjent prosjekt"}),(0,s.jsx)("div",{className:"text-gray-300 text-sm",children:(0,x.GP)((0,h.H)(e.scheduled_date),"EEEE dd.MM")})]},e.id)})})]})}function g(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[o,d]=(0,a.useState)({totalCustomers:0,pendingSpringMaintenance:0,pendingFallMaintenance:0,activeProjects:0}),[m,h]=(0,a.useState)(!0),[x,g]=(0,a.useState)(""),[p,j]=(0,a.useState)([{id:"1",task:"Bestille jord til Torvullvegen",completed:!1,createdAt:new Date().toISOString()},{id:"2",task:"Legge membran Nattenvegen 332",completed:!1,createdAt:new Date().toISOString()},{id:"3",task:"Ringe Kaugerud transport",completed:!1,createdAt:new Date().toISOString()}]),[f,b]=(0,a.useState)(""),[v,y]=(0,a.useState)(!1),[N,w]=(0,a.useState)([]);async function k(){try{let{data:e,error:t}=await i.ND.from("time_entries").select("*").order("date",{ascending:!1}).limit(3);if(t)return void console.error("Error fetching recent time entries:",t);w(e||[])}catch(e){console.error("Unexpected error fetching recent time entries:",e)}}async function S(){try{h(!0);let{data:e,error:r}=await i.ND.from("abonnementer").select("*");if(r)return void console.error("Error fetching customers:",r);if(!e)return;let s=e.length,a=e.filter(e=>"Ja"!==e.var).length,n=e.filter(e=>"Ja"!==e.host).length,{data:o,error:c}=await i.ND.from("projects").select("*").eq("status","active");c&&console.error("Error fetching projects:",c),d({totalCustomers:s,pendingSpringMaintenance:a,pendingFallMaintenance:n,activeProjects:(null==o?void 0:o.length)||0});let m=[...e].sort((e,t)=>{let r=e.fornyelsesdato?new Date(e.fornyelsesdato).getTime():0,s=t.fornyelsesdato?new Date(t.fornyelsesdato).getTime():0;return r-s}).slice(0,5);l(m);let x=[...e].sort((e,t)=>{let r=e.fornyelsesdato?new Date(e.fornyelsesdato).getTime():0;return(t.fornyelsesdato?new Date(t.fornyelsesdato).getTime():0)-r}).slice(0,5);t(x)}catch(e){console.error("Error in fetchDashboardData:",e)}finally{h(!1)}}return(0,a.useEffect)(()=>{S(),k(),g((()=>{let e=new Date().getHours();return e>=5&&e<12?"God morgen":e>=12&&e<17?"God ettermiddag":e>=17&&e<22?"God kveld":"God natt"})())},[]),(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 p-4 md:p-8 ml-0 md:ml-64",children:(0,s.jsxs)("div",{className:"max-w-full md:max-w-7xl xl:w-[140%] xl:-ml-[20%] mx-auto",children:[(0,s.jsx)("p",{className:"text-2xl text-gray-400",children:new Date().toLocaleDateString("no-NO",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}),(0,s.jsxs)("h1",{className:"text-4xl font-bold text-white",children:[x,", ","Edgar"]}),(0,s.jsxs)("div",{className:"mb-12",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-white",children:"Dashboard"}),(0,s.jsx)("p",{className:"text-gray-400 mt-2",children:"Oversikt over aktiviteter og status"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-gray-400",children:"Aktive prosjekter"}),(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-900/50 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white mt-2",children:m?(0,s.jsx)("span",{className:"inline-block w-8 h-6 bg-gray-700 animate-pulse rounded"}):o.activeProjects})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-gray-400",children:"Registrerte abonnementer"}),(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-purple-900/50 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white mt-2",children:m?(0,s.jsx)("span",{className:"inline-block w-8 h-6 bg-gray-700 animate-pulse rounded"}):o.totalCustomers})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-gray-400",children:"Gjenst\xe5r v\xe5rvedlikehold"}),(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white mt-2",children:m?(0,s.jsx)("span",{className:"inline-block w-8 h-6 bg-gray-700 animate-pulse rounded"}):o.pendingSpringMaintenance})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-gray-400",children:"Gjenst\xe5r h\xf8stvedlikehold"}),(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-yellow-900/50 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-white mt-2",children:m?(0,s.jsx)("span",{className:"inline-block w-8 h-6 bg-gray-700 animate-pulse rounded"}):o.pendingFallMaintenance})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Todo-liste"}),(0,s.jsx)("button",{className:"text-sm text-blue-400 hover:text-blue-300",onClick:()=>y(!v),children:"Legg til"})]}),v&&(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),f.trim()&&(j([...p,{id:Date.now().toString(),task:f,completed:!1,createdAt:new Date().toISOString()}]),b(""),y(!1))},className:"mb-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),className:"flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ny oppgave",autoFocus:!0}),(0,s.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:"Lagre"})]})}),(0,s.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 px-4 bg-gray-700/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{className:"w-5 h-5 rounded border ".concat(e.completed?"bg-blue-500 border-blue-500":"border-gray-500"),onClick:()=>j(p.map(t=>t.id===e.id?{...t,completed:!t.completed}:t)),children:e.completed&&(0,s.jsx)("svg",{className:"w-3 h-3 mx-auto text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,s.jsx)("p",{className:"text-white ".concat(e.completed?"line-through text-gray-500":""),children:e.task})]}),(0,s.jsx)("button",{className:"text-gray-400 hover:text-red-400",onClick:()=>j(p.filter(t=>t.id!==e.id)),children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},e.id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(c,{}),(0,s.jsx)(u,{})]})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-4 md:p-6 border border-gray-700",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Nylige aktiviteter"}),(0,s.jsx)("div",{className:"space-y-4",children:0===N.length?(0,s.jsx)("p",{className:"text-gray-400",children:"Ingen nylige timef\xf8ringer"}):N.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-700 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white",children:"Ny timef\xf8ring registrert"}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:["Prosjekt: ",e.project]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[e.date," ",e.start_time," - ",e.end_time]})]})]}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:e.total_hours?"".concat(e.total_hours," t"):""})]},e.id))})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Kommende fornyelser"}),(0,s.jsx)(n(),{href:"/abonnement",className:"text-sm text-blue-400 hover:text-blue-300",children:"Se alle"})]}),m?(0,s.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"h-12 bg-gray-700 animate-pulse rounded"},e))}):r.length>0?(0,s.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white",children:e.etternavn}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:e.adresse})]})]}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:e.fornyelsesdato?new Date(e.fornyelsesdato).toLocaleDateString("no-NO"):"Ikke satt"})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-400",children:"Ingen kommende fornyelser"})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Vedlikehold status"}),(0,s.jsx)(n(),{href:"/abonnement",className:"text-sm text-blue-400 hover:text-blue-300",children:"Se detaljer"})]}),m?(0,s.jsx)("div",{className:"space-y-4",children:[1,2].map(e=>(0,s.jsx)("div",{className:"h-16 bg-gray-700 animate-pulse rounded mb-4"},e))}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"V\xe5rvedlikehold"}),(0,s.jsxs)("span",{className:"text-white",children:[o.pendingSpringMaintenance," gjenst\xe5r"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:"".concat(o.totalCustomers>0?(o.totalCustomers-o.pendingSpringMaintenance)/o.totalCustomers*100:0,"%")}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"H\xf8stvedlikehold"}),(0,s.jsxs)("span",{className:"text-white",children:[o.pendingFallMaintenance," gjenst\xe5r"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"bg-yellow-600 h-2.5 rounded-full",style:{width:"".concat(o.totalCustomers>0?(o.totalCustomers-o.pendingFallMaintenance)/o.totalCustomers*100:0,"%")}})})]}),(0,s.jsx)("div",{className:"pt-2 border-t border-gray-700",children:(0,s.jsx)(n(),{href:"/abonnement/historikk",className:"text-sm text-blue-400 hover:text-blue-300",children:"Se tidligere vedlikehold"})})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Nylig oppdaterte kunder"}),(0,s.jsx)(n(),{href:"/abonnement",className:"text-sm text-blue-400 hover:text-blue-300",children:"Se alle"})]}),m?(0,s.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"h-12 bg-gray-700 animate-pulse rounded"},e))}):e.length>0?(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-700 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white",children:e.etternavn}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:e.adresse})]})]}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:e.fornyelsesdato?new Date(e.fornyelsesdato).toLocaleDateString("no-NO"):"Ikke satt"})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-400",children:"Ingen nylig oppdaterte kunder"})]})]})]})})}},7794:(e,t,r)=>{"use strict";r.d(t,{JQ:()=>a,Ub:()=>d,Z4:()=>c,gA:()=>l,ui:()=>o,vr:()=>n,xx:()=>i});var s=r(2099);async function a(){let{data:e,error:t}=await s.ND.from("projects").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Error fetching projects:",t),t;return e||[]}async function l(e){console.log("Creating project with data:",e);try{console.log("Supabase client:",s.ND);let{data:t,error:r}=await s.ND.from("projects").select("id").limit(1);if(r)throw console.error("Error checking projects table:",r),Error("Table check failed: ".concat(r.message));console.log("Table check result:",t);let{data:a,error:l}=await s.ND.from("projects").insert([e]).select();if(l)throw console.error("Error creating project:",l),Error("Insert failed: ".concat(l.message));return console.log("Project created successfully:",a),null==a?void 0:a[0]}catch(e){throw console.error("Exception in createProject:",e),e}}async function n(e,t){console.log("Updating project with id:",e,"and data:",t);try{let{data:r,error:a}=await s.ND.from("projects").update(t).eq("id",e).select();if(a)throw console.error("Error updating project with id ".concat(e,":"),a),a;return console.log("Project updated successfully:",r),null==r?void 0:r[0]}catch(t){throw console.error("Exception in updateProject for id ".concat(e,":"),t),t}}async function i(e){let{error:t}=await s.ND.from("projects").delete().eq("id",e);if(t)throw console.error("Error deleting project with id ".concat(e,":"),t),t;return!0}async function o(){let{data:e,error:t}=await s.ND.from("scheduled_projects").select("\n      *,\n      projects:project_id (*)\n    ").order("scheduled_date",{ascending:!0});if(t)throw console.error("Error fetching scheduled projects:",t),t;return e||[]}async function c(e,t){let{data:r,error:a}=await s.ND.from("scheduled_projects").insert([{project_id:e,scheduled_date:t}]).select();if(a)throw console.error("Error scheduling project ".concat(e," for date ").concat(t,":"),a),a;return null==r?void 0:r[0]}async function d(e,t){let{error:r}=await s.ND.from("scheduled_projects").delete().eq("project_id",e).eq("scheduled_date",t);if(r)throw console.error("Error unscheduling project ".concat(e," for date ").concat(t,":"),r),r;return!0}}},e=>{var t=t=>e(e.s=t);e.O(0,[851,874,418,441,684,358],()=>t(1846)),_N_E=e.O()}]);
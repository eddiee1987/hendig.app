(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[179],{2099:(e,r,l)=>{"use strict";l.d(r,{HK:()=>c,LY:()=>o,ND:()=>n,qi:()=>d,y9:()=>i});var t=l(851);let s="https://jntsodzdafscwksizfov.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",s),console.log("Supabase Anon Key:",a?"Set":"Not set"),s&&a||console.error("Supabase credentials are not set correctly in environment variables");let n=(0,t.UU)(s,a);async function i(){try{let{data:e,error:r}=await n.from("lager").select("navn, antall");if(r)return console.error("Error fetching lager:",r),{};let l={};return null==e||e.forEach(e=>{l[e.navn.toLowerCase().replaceAll(" ","_").replaceAll("\xe5","a").replaceAll("\xe6","ae").replaceAll("\xf8","o")]=e.antall}),l}catch(e){return console.error("Unexpected error fetching lager:",e),{}}}async function c(e){try{let{data:r,error:l}=await n.from("lager").select("id, navn");if(l)return void console.error("Error fetching lager for update:",l);for(let[l,t]of Object.entries(e)){let e=l.replaceAll("_"," ").replaceAll("ae","\xe6").replaceAll("o","\xf8").replaceAll("a","\xe5"),s=null==r?void 0:r.find(e=>e.navn.toLowerCase().replaceAll(" ","_")===l);s?await n.from("lager").update({antall:Number(t)}).eq("id",s.id):await n.from("lager").insert([{navn:e,antall:Number(t)}])}}catch(e){console.error("Unexpected error updating lager:",e)}}async function d(){try{let{data:e,error:r}=await n.from("lager_transactions").select("created_at, type, antall, kommentar, lager_id, lager:lager_id(navn)").order("created_at",{ascending:!1}).limit(100);if(r)return console.error("Error fetching lager historikk:",r),window.__supabaseLagerHistorikkError=r,[];return(e||[]).map(e=>{var r,l;return{created_at:e.created_at,navn:(null==(l=e.lager)||null==(r=l[0])?void 0:r.navn)||"",type:e.type,antall:e.antall,kommentar:e.kommentar||""}})}catch(e){return console.error("Unexpected error fetching lager historikk:",e),[]}}async function o(e){let{key:r,type:l,antall:t,kommentar:s}=e;try{let e=r.replaceAll("_"," ").replaceAll("ae","\xe6").replaceAll("o","\xf8").replaceAll("a","\xe5"),a=null,i=0,{data:c}=await n.from("lager").select("id, antall").eq("navn",e).limit(1);if(c&&0!==c.length){if(a=c[0].id,i=c[0].antall,"inntak"===l)i+=t;else if("uttak"===l){if(c[0].antall<t)return{error:"Ikke nok p\xe5 lager for uttak"};i-=t}else"manuell"===l&&(i=t);let{error:e}=await n.from("lager").update({antall:i}).eq("id",a);if(e)return{error:"Kunne ikke oppdatere lagerbeholdning"}}else{if("manuell"!==l)return{error:"Fant ikke varen i lageret"};let{data:r,error:s}=await n.from("lager").insert([{navn:e,antall:Number(t)}]).select("id").single();if(s||!r)return{error:"Kunne ikke opprette ny vare"};a=r.id,i=Number(t)}let{error:d}=await n.from("lager_transactions").insert({lager_id:a,type:l,antall:t,kommentar:s});if(d)return{error:"Kunne ikke registrere transaksjon"};return{success:!0}}catch(e){return{error:"Uventet feil ved registrering"}}}},4113:(e,r,l)=>{"use strict";l.r(r),l.d(r,{default:()=>n});var t=l(5155),s=l(2115),a=l(2099);function n(){let[e,r]=(0,s.useState)({name:"Edgar Eidsheim",email:"edgar@driftig.no",role:"Driftsleder",phone:"+47 123 45 678",department:"Drift",profileImage:"/images/edgar.jpg"}),[l,n]=(0,s.useState)(!1),i=(0,s.useRef)(null),[c,d]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(0,a.qi)().then(d)},[]),(0,t.jsx)("div",{className:"min-h-screen bg-gray-900 p-8 ml-64",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-12",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-white",children:"Min side"}),(0,t.jsx)("p",{className:"text-gray-400 mt-2",children:"Din personlige oversikt"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Profilinformasjon"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[e.profileImage?(0,t.jsx)("img",{src:e.profileImage,alt:"Profilbilde",className:"w-16 h-16 rounded-full border-2 border-gray-700"}):(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-blue-900/50 flex items-center justify-center",children:(0,t.jsxs)("svg",{viewBox:"0 0 64 64",className:"w-12 h-12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,t.jsx)("circle",{cx:"32",cy:"32",r:"30",fill:"#FCD7B6"}),(0,t.jsx)("ellipse",{cx:"32",cy:"40",rx:"14",ry:"10",fill:"#fff"}),(0,t.jsx)("ellipse",{cx:"22",cy:"28",rx:"3",ry:"4",fill:"#222"}),(0,t.jsx)("ellipse",{cx:"42",cy:"28",rx:"3",ry:"4",fill:"#222"}),(0,t.jsx)("rect",{x:"22",y:"44",width:"20",height:"6",rx:"3",fill:"#B07D56"}),(0,t.jsx)("path",{d:"M20 44c2 3 8 5 12 5s10-2 12-5",stroke:"#222",strokeWidth:"2",strokeLinecap:"round"}),(0,t.jsx)("rect",{x:"24",y:"38",width:"16",height:"4",rx:"2",fill:"#222"}),(0,t.jsx)("ellipse",{cx:"32",cy:"50",rx:"6",ry:"2",fill:"#B07D56"})]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Navn"}),(0,t.jsx)("p",{className:"mt-1 text-white",children:e.name})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("button",{onClick:()=>{var e;return null==(e=i.current)?void 0:e.click()},className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Endre bilde"}),(0,t.jsx)("input",{type:"file",ref:i,onChange:e=>{var l;let t=null==(l=e.target.files)?void 0:l[0];if(t){let e=new FileReader;e.onload=()=>{e.result&&r(r=>({...r,profileImage:e.result}))},e.readAsDataURL(t)}},className:"hidden",accept:"image/*"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"E-post"}),(0,t.jsx)("p",{className:"mt-1 text-white",children:e.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Telefon"}),(0,t.jsx)("p",{className:"mt-1 text-white",children:e.phone})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Stilling"}),(0,t.jsx)("p",{className:"mt-1 text-white",children:e.role})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:()=>{console.log("Profil lagret:",e),n(!1)},className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Lagre profil"})})]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Statistikk"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Antall inspeksjoner denne m\xe5neden"}),(0,t.jsx)("p",{className:"mt-1 text-2xl font-bold text-white",children:"24"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Timer registrert denne m\xe5neden"}),(0,t.jsx)("p",{className:"mt-1 text-2xl font-bold text-white",children:"156"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Aktive prosjekter"}),(0,t.jsx)("p",{className:"mt-1 text-2xl font-bold text-white",children:"8"})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-2xl p-6 border border-gray-700 md:col-span-2",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:"Nylige aktiviteter"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-700/50 rounded-xl",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-900/50 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white",children:"Fullf\xf8rte inspeksjon av Bygning A"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"2 timer siden"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-700/50 rounded-xl",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-900/50 flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white",children:"Registrerte 4 timer p\xe5 Prosjekt X"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"5 timer siden"})]})]})]}),(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Lagerhistorikk"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-gray-300",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("th",{className:"py-2",children:"Dato"}),(0,t.jsx)("th",{className:"py-2",children:"Vare"}),(0,t.jsx)("th",{className:"py-2",children:"Type"}),(0,t.jsx)("th",{className:"py-2",children:"Antall"}),(0,t.jsx)("th",{className:"py-2",children:"Kommentar"})]})}),(0,t.jsxs)("tbody",{children:[0===c.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:5,className:"text-center py-4 text-gray-500",children:"Ingen lagerhistorikk funnet"})}),c.map((e,r)=>(0,t.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,t.jsx)("td",{className:"py-2",children:new Date(e.created_at).toLocaleString("nb-NO")}),(0,t.jsx)("td",{className:"py-2",children:e.navn}),(0,t.jsx)("td",{className:"py-2",children:(0,t.jsx)("span",{className:"inntak"===e.type?"text-green-400":"text-red-400",children:"inntak"===e.type?"Inntak":"Uttak"})}),(0,t.jsx)("td",{className:"py-2",children:e.antall}),(0,t.jsx)("td",{className:"py-2",children:e.kommentar})]},r))]})]})})]})]})]})]})})}},8112:(e,r,l)=>{Promise.resolve().then(l.bind(l,4113))}},e=>{var r=r=>e(e.s=r);e.O(0,[851,441,684,358],()=>r(8112)),_N_E=e.O()}]);
exports.id=486,exports.ids=[486],exports.modules={4780:(e,t,r)=>{"use strict";r.d(t,{cn:()=>a});var s=r(49384),n=r(82348);function a(...e){return(0,n.QP)((0,s.$)(e))}},16391:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var s=r(94025);let n="https://jntsodzdafscwksizfov.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpudHNvZHpkYWZzY3drc2l6Zm92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDM1NTU1NDAsImV4cCI6MjA1OTEzMTU0MH0.bHJS17KYKP4n2Abs0rp2oO0pFBGW3GorNhsJFyDljR8";console.log("Supabase URL:",n),console.log("Supabase Anon Key:",a?"Set":"Not set"),n&&a||console.error("Supabase credentials are not set correctly in environment variables");let l=(0,s.UU)(n,a)},27181:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,16444,23)),Promise.resolve().then(r.t.bind(r,16042,23)),Promise.resolve().then(r.t.bind(r,88170,23)),Promise.resolve().then(r.t.bind(r,49477,23)),Promise.resolve().then(r.t.bind(r,29345,23)),Promise.resolve().then(r.t.bind(r,12089,23)),Promise.resolve().then(r.t.bind(r,46577,23)),Promise.resolve().then(r.t.bind(r,31307,23))},28735:(e,t,r)=>{Promise.resolve().then(r.bind(r,37590)),Promise.resolve().then(r.bind(r,29190))},29190:(e,t,r)=>{"use strict";r.d(t,{default:()=>v});var s=r(60687),n=r(85814),a=r.n(n),l=r(43210),o=r(16189),i=r(4780),d=r(50515),c=r(27446),m=r(724),x=r(45667),h=r(2969),u=r(83188),g=r(87061),b=r(45994),f=r(81836),p=r(6510);function v(){let[e,t]=(0,l.useState)(!1),[r,n]=(0,l.useState)(!1),v=(0,o.usePathname)(),j=e||r,y=[{href:"/timeforing",icon:d.A,label:"Timef\xf8ring"},{href:"/inspeksjoner",icon:c.A,label:"Inspeksjoner"},{href:"/abonnement",icon:m.A,label:"Abonnement"},{href:"/prosjekter",icon:x.A,label:"Prosjekter"},{href:"/planlegging",icon:h.A,label:"Planlegging"},{href:"/kunder",icon:u.A,label:"Kunder"},{href:"/ansatte",icon:g.A,label:"Ansatte"},{href:"/rapport",icon:b.A,label:"Rapport"}];return(0,s.jsxs)("nav",{className:(0,i.cn)("fixed left-0 top-0 h-screen bg-gray-900 border-r border-gray-800 flex flex-col transition-all duration-300 ease-in-out z-10",j?"w-64":"w-16"),onMouseEnter:()=>{n(!0)},onMouseLeave:()=>{n(!1)},children:["a",(0,s.jsxs)("div",{className:(0,i.cn)("flex items-center border-b border-gray-800",j?"justify-between p-6":"justify-center p-4"),children:[j&&(0,s.jsx)(a(),{href:"/dashboard",className:"text-2xl font-bold text-white",children:"Hendig"}),(0,s.jsx)("button",{onClick:()=>{t(!e)},className:"text-gray-400 hover:text-white transition-colors","aria-label":e?"Minimer meny":"Utvid meny",children:e?(0,s.jsx)(f.A,{className:"w-5 h-5"}):(0,s.jsx)(p.A,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"flex-1 p-2",children:(0,s.jsx)("ul",{className:"space-y-2",children:y.map(e=>{let t=v===e.href,r=e.icon;return(0,s.jsx)("li",{children:(0,s.jsxs)(a(),{href:e.href,className:(0,i.cn)("flex items-center p-3 rounded-lg transition-colors",t?"bg-gray-800 text-white":"text-gray-400 hover:bg-gray-800 hover:text-white",!j&&"justify-center"),title:j?void 0:e.label,children:[(0,s.jsx)(r,{className:(0,i.cn)("w-5 h-5",j?"mr-3":"mx-auto")}),j&&(0,s.jsx)("span",{children:e.label})]})},e.href)})})}),(0,s.jsx)("div",{className:(0,i.cn)("border-t border-gray-800",j?"p-4":"p-2"),children:(0,s.jsxs)("div",{className:(0,i.cn)("flex items-center p-3 rounded-lg hover:bg-gray-800 transition-colors",!j&&"justify-center"),children:[(0,s.jsx)(u.A,{className:(0,i.cn)("w-8 h-8 text-gray-400",j?"mr-3":"")}),j&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white",children:"Admin"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"admin@example.com"})]})]})})]})}},30004:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Eidsheim\\\\Kopi av driftig 10.04.25\\\\.ssh\\\\driftig\\\\src\\\\components\\\\Navbar.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Eidsheim\\Kopi av driftig 10.04.25\\.ssh\\driftig\\src\\components\\Navbar.tsx","default")},46887:(e,t,r)=>{Promise.resolve().then(r.bind(r,5625)),Promise.resolve().then(r.bind(r,30004))},61135:()=>{},70440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var s=r(31658);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},74445:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,86346,23)),Promise.resolve().then(r.t.bind(r,27924,23)),Promise.resolve().then(r.t.bind(r,35656,23)),Promise.resolve().then(r.t.bind(r,40099,23)),Promise.resolve().then(r.t.bind(r,38243,23)),Promise.resolve().then(r.t.bind(r,28827,23)),Promise.resolve().then(r.t.bind(r,62763,23)),Promise.resolve().then(r.t.bind(r,97173,23))},93996:(e,t,r)=>{"use strict";r.d(t,{JQ:()=>n,Ub:()=>c,Z4:()=>d,gA:()=>a,ui:()=>i,vr:()=>l,xx:()=>o});var s=r(16391);async function n(){let{data:e,error:t}=await s.N.from("projects").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Error fetching projects:",t),t;return e||[]}async function a(e){console.log("Creating project with data:",e);try{console.log("Supabase client:",s.N);let{data:t,error:r}=await s.N.from("projects").select("id").limit(1);if(r)throw console.error("Error checking projects table:",r),Error(`Table check failed: ${r.message}`);console.log("Table check result:",t);let{data:n,error:a}=await s.N.from("projects").insert([e]).select();if(a)throw console.error("Error creating project:",a),Error(`Insert failed: ${a.message}`);return console.log("Project created successfully:",n),n?.[0]}catch(e){throw console.error("Exception in createProject:",e),e}}async function l(e,t){console.log("Updating project with id:",e,"and data:",t);try{let{data:r,error:n}=await s.N.from("projects").update(t).eq("id",e).select();if(n)throw console.error(`Error updating project with id ${e}:`,n),n;return console.log("Project updated successfully:",r),r?.[0]}catch(t){throw console.error(`Exception in updateProject for id ${e}:`,t),t}}async function o(e){let{error:t}=await s.N.from("projects").delete().eq("id",e);if(t)throw console.error(`Error deleting project with id ${e}:`,t),t;return!0}async function i(){let{data:e,error:t}=await s.N.from("scheduled_projects").select(`
      *,
      projects:project_id (*)
    `).order("scheduled_date",{ascending:!0});if(t)throw console.error("Error fetching scheduled projects:",t),t;return e||[]}async function d(e,t){let{data:r,error:n}=await s.N.from("scheduled_projects").insert([{project_id:e,scheduled_date:t}]).select();if(n)throw console.error(`Error scheduling project ${e} for date ${t}:`,n),n;return r?.[0]}async function c(e,t){let{error:r}=await s.N.from("scheduled_projects").delete().eq("project_id",e).eq("scheduled_date",t);if(r)throw console.error(`Error unscheduling project ${e} for date ${t}:`,r),r;return!0}},94431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>l});var s=r(37413);r(61135);var n=r(30004),a=r(5625);let l={title:"Driftig",description:"Driftig - Administrasjonssystem"};function o({children:e}){return(0,s.jsx)("html",{lang:"no",className:"dark",children:(0,s.jsxs)("body",{className:"bg-gray-900 text-gray-100",children:[(0,s.jsxs)("div",{className:"flex min-h-screen",children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("main",{className:"flex-1 transition-all duration-300 ml-16 p-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto",children:e})})]}),(0,s.jsx)(a.Toaster,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#333",color:"#fff"}}})]})})}},94680:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var s=r(60687),n=r(43210),a=r(2969);let l=n.forwardRef(function({title:e,titleId:t,...r},s){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z"}))}),o=n.forwardRef(function({title:e,titleId:t,...r},s){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}),i=n.forwardRef(function({title:e,titleId:t,...r},s){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":t},r),e?n.createElement("title",{id:t},e):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))});var d=r(93996),c=r(98980),m=r(37590);function x({projects:e,abonnements:t}){let[r,x]=(0,n.useState)("month"),[h,u]=(0,n.useState)(new Date),[g,b]=(0,n.useState)([]),[f,p]=(0,n.useState)([]),[v,j]=(0,n.useState)([]),[y,w]=(0,n.useState)("all"),[N,k]=(0,n.useState)(!1),[D,S]=(0,n.useState)(null),[$,I]=(0,n.useState)(null),[E,A]=(0,n.useState)(null),[O,C]=(0,n.useState)(null),[P,L]=(0,n.useState)(!0),[M,T]=(0,n.useState)("projects"),R=(0,n.useRef)(0),F=(0,n.useRef)(null),_=e=>["Man","Tirs","Ons","Tors","Fre","L\xf8r","S\xf8n"][e],U=e=>{S(e)},z=(e,t)=>{e.preventDefault()},J=e=>{e.preventDefault(),R.current++},K=e=>{e.preventDefault(),R.current--},V=async(e,t)=>{e.preventDefault(),R.current=0;let r=t.toISOString().split("T")[0];if(D){if(f.some(e=>e.id===D.id&&e.scheduledDate===r))return void S(null);try{let e=await (0,d.Z4)(D.id,r);if(e){let t={...D,scheduledDate:r,scheduledId:e.id};p([...f,t]),m.oR.success("Prosjekt planlagt")}}catch(e){console.error("Error scheduling project:",e),m.oR.error("Kunne ikke planlegge prosjekt")}finally{S(null)}}if($){if(!$.id){m.oR.error("Ugyldig vedlikeholdsavtale - mangler ID"),I(null);return}if(v.some(e=>e.id===$.id&&e.scheduledDate===r))return void I(null);try{console.log("Attempting to schedule abonnement:",{id:$.id,date:r});let e=await (0,c.lt)($.id,r);if(e){console.log("Successfully scheduled abonnement:",e);let t={...$,scheduledDate:r,scheduledId:e.id};j([...v,t]),m.oR.success("Vedlikeholdsavtale planlagt")}else console.error("No result returned from scheduleAbonnement"),m.oR.error("Ingen data returnert fra server")}catch(e){console.error("Detailed error scheduling abonnement:",{error:e instanceof Error?e.message:e,stack:e instanceof Error?e.stack:void 0,abonnementId:$.id,date:r}),e instanceof Error?e.message.includes("JWT expired")||e.message.includes("Invalid API key")?m.oR.error("Autentiseringsfeil - sjekk API-n\xf8kkel"):e.message.includes("foreign key constraint")?m.oR.error("Ugyldig vedlikeholdsavtale-ID"):m.oR.error(`Feil ved planlegging: ${e.message}`):m.oR.error("Ukjent feil ved planlegging")}finally{I(null)}}},Z=async(e,t)=>{try{await (0,d.Ub)(e,t),p(f.filter(r=>r.id!==e||r.scheduledDate!==t)),m.oR.success("Prosjekt fjernet fra kalender")}catch(e){console.error("Error removing project from calendar:",e),m.oR.error("Kunne ikke fjerne prosjekt fra kalender")}},Y=async(e,t)=>{try{await (0,c.NA)(e,t),j(v.filter(r=>r.id!==e||r.scheduledDate!==t)),m.oR.success("Vedlikeholdsavtale fjernet fra kalender")}catch(e){console.error("Error removing abonnement from calendar:",e),m.oR.error("Kunne ikke fjerne vedlikeholdsavtale fra kalender")}},q="all"===y?e:e.filter(e=>e.status===y);return(0,s.jsx)("div",{className:"bg-gray-900 rounded-xl border border-gray-800",children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex border-b border-gray-800",children:[(0,s.jsxs)("button",{className:`px-4 py-3 text-sm font-medium flex items-center ${"month"===r?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,onClick:()=>x("month"),children:[(0,s.jsx)(a.A,{className:"w-4 h-4 mr-2"}),"M\xe5ned"]}),(0,s.jsxs)("button",{className:`px-4 py-3 text-sm font-medium flex items-center ${"week"===r?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,onClick:()=>x("week"),children:[(0,s.jsx)(a.A,{className:"w-4 h-4 mr-2"}),"Uke"]}),(0,s.jsxs)("button",{className:`px-4 py-3 text-sm font-medium flex items-center ${"day"===r?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,onClick:()=>x("day"),children:[(0,s.jsx)(a.A,{className:"w-4 h-4 mr-2"}),"Dag"]})]}),(0,s.jsxs)("div",{className:"flex flex-1",children:[(0,s.jsxs)("div",{className:"w-1/4 border-r border-gray-800 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex border-b border-gray-700",children:[(0,s.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium ${"projects"===M?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,onClick:()=>T("projects"),children:"Prosjekter"}),(0,s.jsx)("button",{className:`flex-1 px-4 py-2 text-sm font-medium ${"abonnements"===M?"text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white"}`,onClick:()=>T("abonnements"),children:"Vedlikeholdsavtaler"})]}),"projects"===M&&(0,s.jsxs)("div",{className:"p-4 flex-1 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-white",children:"Prosjekter"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>k(!N),className:"flex items-center text-sm text-gray-400 hover:text-white",children:[(0,s.jsx)(l,{className:"w-4 h-4 mr-1"}),"Filter: ","all"===y?"Alle":"active"===y?"Aktive":"completed"===y?"Fullf\xf8rte":"Arkiverte"]}),(0,s.jsx)("div",{ref:F,className:`absolute right-0 mt-2 w-48 bg-gray-800 rounded-lg shadow-lg z-10 ${N?"block":"hidden"}`,children:(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{w("all"),k(!1)},children:"Alle"}),(0,s.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{w("active"),k(!1)},children:"Aktive"}),(0,s.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{w("completed"),k(!1)},children:"Fullf\xf8rte"}),(0,s.jsx)("button",{className:"block w-full text-left px-4 py-2 text-sm text-gray-400 hover:bg-gray-700 hover:text-white",onClick:()=>{w("archived"),k(!1)},children:"Arkiverte"})]})})]})]}),(0,s.jsx)("div",{className:"space-y-2 overflow-y-auto flex-1",children:q.map(e=>(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3 cursor-move hover:bg-gray-750 border border-gray-700",draggable:!0,onDragStart:()=>U(e),children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-white",children:e.name}),(0,s.jsx)("span",{className:`px-1.5 py-0.5 rounded-full text-xs font-medium ${"high"===e.priority?"bg-red-900/50 text-red-400":"medium"===e.priority?"bg-yellow-900/50 text-yellow-400":"bg-green-900/50 text-green-400"}`,children:e.priority})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1 truncate",children:e.client})]},e.id))})]}),"abonnements"===M&&(0,s.jsxs)("div",{className:"p-4 flex-1 flex flex-col",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,s.jsx)("h3",{className:"text-lg font-medium text-white",children:"Vedlikeholdsavtaler"})}),(0,s.jsx)("div",{className:"space-y-2 overflow-y-auto flex-1",children:t.map(e=>(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3 cursor-move hover:bg-gray-750 border border-gray-700",draggable:!0,onDragStart:()=>{I(e),S(null)},children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-white",children:e.etternavn}),(0,s.jsx)("span",{className:"px-1.5 py-0.5 rounded-full text-xs font-medium bg-blue-900/50 text-blue-400",children:"Vedlikehold"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1 truncate",children:e.adresse}),(0,s.jsx)("p",{className:"text-xs text-gray-400 truncate",children:e.kommune})]},e.id))})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-800",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:(()=>{if("month"===r)return h.toLocaleDateString("nb-NO",{month:"long",year:"numeric"});if("week"!==r)return h.toLocaleDateString("nb-NO",{weekday:"long",day:"numeric",month:"long",year:"numeric"});{let e=new Date(h),t=e.getDay();e.setDate(e.getDate()+(0===t?-6:1-t));let r=new Date(e);r.setDate(r.getDate()+6);let s=e.getMonth()===r.getMonth()?"":e.toLocaleDateString("nb-NO",{month:"long"})+" ";return`${s}${e.getDate()}. - ${r.toLocaleDateString("nb-NO",{day:"numeric",month:"long",year:"numeric"})}`}})()}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{if("month"===r)u(new Date(h.getFullYear(),h.getMonth()-1,1));else if("week"===r){let e=new Date(h);e.setDate(e.getDate()-7),u(e)}else if("day"===r){let e=new Date(h);e.setDate(e.getDate()-1),u(e)}},className:"p-1.5 rounded-full text-gray-400 hover:text-white hover:bg-gray-800",children:(0,s.jsx)(o,{className:"w-5 h-5"})}),(0,s.jsx)("button",{onClick:()=>{u(new Date)},className:"px-3 py-1.5 text-sm text-gray-400 hover:text-white",children:"I dag"}),(0,s.jsx)("button",{onClick:()=>{if("month"===r)u(new Date(h.getFullYear(),h.getMonth()+1,1));else if("week"===r){let e=new Date(h);e.setDate(e.getDate()+7),u(e)}else if("day"===r){let e=new Date(h);e.setDate(e.getDate()+1),u(e)}},className:"p-1.5 rounded-full text-gray-400 hover:text-white hover:bg-gray-800",children:(0,s.jsx)(i,{className:"w-5 h-5"})})]})]}),(0,s.jsxs)("div",{className:"flex-1 p-2",children:["month"===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-1",children:[0,1,2,3,4,5,6].map(e=>(0,s.jsx)("div",{className:"text-center text-xs font-medium text-gray-400 py-1",children:_(e)},e))}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 flex-1",children:g.map((e,t)=>(0,s.jsxs)("div",{className:`min-h-[100px] rounded-lg border ${e.isCurrentMonth?e.isToday?"bg-blue-900/20 border-blue-800":"bg-gray-800 border-gray-700":"bg-gray-850 border-gray-800"} p-1 relative`,onDragOver:t=>z(t,e.date),onDragEnter:J,onDragLeave:K,onDrop:t=>V(t,e.date),children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-1",children:(0,s.jsx)("span",{className:`text-xs font-medium ${e.isCurrentMonth?e.isToday?"text-blue-400":"text-white":"text-gray-500"}`,children:e.dayOfMonth})}),(0,s.jsxs)("div",{className:"space-y-1 overflow-y-auto max-h-[80px] min-h-[60px]",onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("bg-gray-700/50")},onDragLeave:e=>{e.currentTarget.classList.remove("bg-gray-700/50")},onDrop:t=>{t.preventDefault(),t.currentTarget.classList.remove("bg-gray-700/50"),V(t,e.date)},children:[e.projects.map(t=>(0,s.jsxs)("div",{className:`text-xs p-1 rounded relative cursor-move transition-all duration-200 hover:shadow-lg ${"high"===t.priority?"bg-red-900/30 text-red-400 border border-red-800/50 hover:bg-red-900/40":"medium"===t.priority?"bg-yellow-900/30 text-yellow-400 border border-yellow-800/50 hover:bg-yellow-900/40":"bg-green-900/30 text-green-400 border border-green-800/50 hover:bg-green-900/40"}`,onMouseEnter:()=>A(`${t.id}-${e.date.toISOString()}`),onMouseLeave:()=>A(null),children:[(0,s.jsx)("div",{className:"truncate",children:t.name}),E===`${t.id}-${e.date.toISOString()}`&&(0,s.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-48 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-2 text-xs",children:[(0,s.jsx)("h5",{className:"font-medium text-white mb-1",children:t.name}),(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:t.client}),(0,s.jsx)("p",{className:"text-gray-400 mb-1 line-clamp-2",children:t.description}),(0,s.jsx)("button",{onClick:()=>Z(t.id,e.date.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs mt-1",children:"Fjern fra kalender"})]})]},`project-${t.id}-${e.date.toISOString()}`)),e.abonnements.map(t=>(0,s.jsxs)("div",{className:"text-xs p-1 rounded relative cursor-move transition-all duration-200 hover:shadow-lg bg-blue-900/30 text-blue-400 border border-blue-800/50 hover:bg-blue-900/40",onMouseEnter:()=>C(`${t.id}-${e.date.toISOString()}`),onMouseLeave:()=>C(null),children:[(0,s.jsx)("div",{className:"truncate",children:t.etternavn}),O===`${t.id}-${e.date.toISOString()}`&&(0,s.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-48 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-2 text-xs",children:[(0,s.jsx)("h5",{className:"font-medium text-white mb-1",children:t.etternavn}),(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:t.adresse}),(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:t.kommune}),(0,s.jsx)("button",{onClick:()=>Y(t.id,e.date.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs mt-1",children:"Fjern fra kalender"})]})]},`abonnement-${t.id}-${e.date.toISOString()}`))]})]},t))})]}),"week"===r&&(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Array.from({length:7}).map((e,t)=>{let r=new Date(h),n=r.getDay(),a=t-(0===n?6:n-1);return r.setDate(r.getDate()+a),(0,s.jsxs)("div",{className:"text-center py-2",children:[(0,s.jsx)("div",{className:"text-xs font-medium text-gray-400",children:_(t)}),(0,s.jsx)("div",{className:`text-sm font-medium ${r.toDateString()===new Date().toDateString()?"text-blue-400":"text-white"}`,children:r.getDate()})]},t)})}),(0,s.jsx)("div",{className:"grid grid-cols-7 gap-1 flex-1",children:Array.from({length:7}).map((e,t)=>{let r=new Date(h),n=r.getDay(),a=t-(0===n?6:n-1);r.setDate(r.getDate()+a);let l=r.toISOString().split("T")[0],o=f.filter(e=>e.scheduledDate===l),i=v.filter(e=>e.scheduledDate===l);return(0,s.jsx)("div",{className:`min-h-[400px] rounded-lg border ${r.toDateString()===new Date().toDateString()?"bg-blue-900/20 border-blue-800":"bg-gray-800 border-gray-700"} p-2 relative`,onDragOver:e=>z(e,r),onDragEnter:J,onDragLeave:K,onDrop:e=>V(e,r),children:(0,s.jsxs)("div",{className:"space-y-2 overflow-y-auto max-h-full",children:[o.map(e=>(0,s.jsxs)("div",{className:`p-2 rounded relative ${"high"===e.priority?"bg-red-900/30 text-red-400 border border-red-800/50":"medium"===e.priority?"bg-yellow-900/30 text-yellow-400 border border-yellow-800/50":"bg-green-900/30 text-green-400 border border-green-800/50"}`,onMouseEnter:()=>A(`${e.id}-${r.toISOString()}`),onMouseLeave:()=>A(null),children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),(0,s.jsx)("div",{className:"text-xs mt-1",children:e.client}),E===`${e.id}-${r.toISOString()}`&&(0,s.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-64 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-3 text-sm",children:[(0,s.jsx)("h5",{className:"font-medium text-white mb-1",children:e.name}),(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:e.client}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:e.description}),(0,s.jsx)("button",{onClick:()=>Z(e.id,l),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},`project-${e.id}-${r.toISOString()}`)),i.map(e=>(0,s.jsxs)("div",{className:"p-2 rounded relative bg-blue-900/30 text-blue-400 border border-blue-800/50",onMouseEnter:()=>C(`${e.id}-${r.toISOString()}`),onMouseLeave:()=>C(null),children:[(0,s.jsx)("div",{className:"font-medium",children:e.etternavn}),(0,s.jsx)("div",{className:"text-xs mt-1",children:e.adresse}),O===`${e.id}-${r.toISOString()}`&&(0,s.jsxs)("div",{className:"absolute z-10 left-0 top-full mt-1 w-64 bg-gray-900 rounded-lg shadow-lg border border-gray-700 p-3 text-sm",children:[(0,s.jsx)("h5",{className:"font-medium text-white mb-1",children:e.etternavn}),(0,s.jsx)("p",{className:"text-gray-400 mb-1",children:e.adresse}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:e.kommune}),(0,s.jsx)("button",{onClick:()=>Y(e.id,l),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},`abonnement-${e.id}-${r.toISOString()}`))]})},t)})})]}),"day"===r&&(0,s.jsx)("div",{className:"flex flex-col h-full",children:(0,s.jsx)("div",{className:"flex-1 p-4 bg-gray-800 rounded-lg border border-gray-700 mt-2 overflow-y-auto",onDragOver:e=>z(e,h),onDragEnter:J,onDragLeave:K,onDrop:e=>V(e,h),children:(0,s.jsxs)("div",{className:"space-y-3",children:[f.filter(e=>e.scheduledDate===h.toISOString().split("T")[0]).map(e=>(0,s.jsxs)("div",{className:`p-4 rounded-lg relative ${"high"===e.priority?"bg-red-900/30 text-red-400 border border-red-800/50":"medium"===e.priority?"bg-yellow-900/30 text-yellow-400 border border-yellow-800/50":"bg-green-900/30 text-green-400 border border-green-800/50"}`,children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h4",{className:"font-medium text-white",children:e.name}),(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${"active"===e.status?"bg-blue-900/50 text-blue-400":"completed"===e.status?"bg-green-900/50 text-green-400":"bg-gray-900/50 text-gray-400"}`,children:e.status})]}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:e.description}),(0,s.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["Klient: ",(0,s.jsx)("span",{className:"text-white",children:e.client})]}),(0,s.jsx)("button",{onClick:()=>Z(e.id,h.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},`project-${e.id}`)),v.filter(e=>e.scheduledDate===h.toISOString().split("T")[0]).map(e=>(0,s.jsxs)("div",{className:"p-4 rounded-lg relative bg-blue-900/30 text-blue-400 border border-blue-800/50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("h4",{className:"font-medium text-white",children:e.etternavn}),(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-900/50 text-blue-400",children:"Vedlikehold"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:e.adresse}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:e.kommune}),(0,s.jsxs)("div",{className:"mt-3 flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["Fornyelse: ",(0,s.jsx)("span",{className:"text-white",children:e.fornyelsesdato})]}),(0,s.jsx)("button",{onClick:()=>Y(e.id,h.toISOString().split("T")[0]),className:"text-red-400 hover:text-red-300 text-xs",children:"Fjern fra kalender"})]})]},`abonnement-${e.id}`)),0===f.filter(e=>e.scheduledDate===h.toISOString().split("T")[0]).length&&0===v.filter(e=>e.scheduledDate===h.toISOString().split("T")[0]).length&&(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("p",{children:"Ingen aktiviteter planlagt for denne dagen"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:"Dra et prosjekt eller en vedlikeholdsavtale hit for \xe5 planlegge det"})]})]})})})]})]})]})]})})}},98980:(e,t,r)=>{"use strict";r.d(t,{CL:()=>i,NA:()=>o,R2:()=>n,lt:()=>l,s2:()=>a});var s=r(16391);async function n(){let{data:e,error:t}=await s.N.from("abonnementer").select("*").order("etternavn",{ascending:!0});if(t)throw console.error("Error fetching abonnements:",t),t;return e||[]}async function a(){let{data:e,error:t}=await s.N.from("scheduled_abonnements").select(`
      *,
      abonnementer:abonnement_id (*)
    `).order("scheduled_date",{ascending:!0});if(t)throw console.error("Error fetching scheduled abonnements:",t),t;return e||[]}async function l(e,t){try{let r=Number(e);if(isNaN(r))throw Error(`Invalid abonnement ID: ${e}`);if(!t||!Date.parse(t))throw Error(`Invalid date format: ${t}`);let{data:n,error:a}=await s.N.from("scheduled_abonnements").insert([{abonnement_id:r,scheduled_date:t}]).select();if(a)throw console.error(`Error scheduling abonnement ${e} for date ${t}:`,{message:a.message,code:a.code,details:a.details,hint:a.hint}),Error(`Failed to schedule: ${a.message}`);if(!n||0===n.length)throw Error("No data returned from scheduling operation");return n[0]}catch(t){throw console.error(`Failed to schedule abonnement ${e}:`,{error:t instanceof Error?t.message:t,stack:t instanceof Error?t.stack:void 0}),Error(`Failed to schedule abonnement: ${t instanceof Error?t.message:"Unknown error"}`)}}async function o(e,t){let{error:r}=await s.N.from("scheduled_abonnements").delete().eq("abonnement_id",e).eq("scheduled_date",t);if(r)throw console.error(`Error unscheduling abonnement ${e} for date ${t}:`,r),r;return!0}async function i(e){let{data:t,error:r}=await s.N.from("abonnementer").insert([{fornavn:e.fornavn,etternavn:e.etternavn,adresse:e.adresse,kommune:e.kommune,var:e.var,host:e.host,epost:e.epost,fakturert:e.fakturert,fornyelsesdato:e.fornyelsesdato,sum:e.sum,notat:e.notat}]).select();if(r)throw console.error("Error creating abonnement:",r),r;return t?.[0]}}};